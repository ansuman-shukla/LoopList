var Ar=e=>{throw TypeError(e)};var Qt=(e,t,r)=>t.has(e)||Ar("Cannot "+r);var c=(e,t,r)=>(Qt(e,t,"read from private field"),r?r.call(e):t.get(e)),O=(e,t,r)=>t.has(e)?Ar("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),A=(e,t,r,s)=>(Qt(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),F=(e,t,r)=>(Qt(e,t,"access private method"),r);var Nt=(e,t,r,s)=>({set _(a){A(e,t,a,r)},get _(){return c(e,t,s)}});import{a as rn,b as sn,r as k,u as le,L as $,c as fs,H as nn,d as an,e as de,N as on}from"./vendor-CYWZ3JPx.js";import{C as ln}from"./ui-DLISAjjV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var zt={exports:{}},ft={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lr;function cn(){if(Lr)return ft;Lr=1;var e=rn(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(l,d,f){var u,h={},v=null,w=null;f!==void 0&&(v=""+f),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(w=d.ref);for(u in d)s.call(d,u)&&!o.hasOwnProperty(u)&&(h[u]=d[u]);if(l&&l.defaultProps)for(u in d=l.defaultProps,d)h[u]===void 0&&(h[u]=d[u]);return{$$typeof:t,type:l,key:v,ref:w,props:h,_owner:a.current}}return ft.Fragment=r,ft.jsx=i,ft.jsxs=i,ft}var Dr;function dn(){return Dr||(Dr=1,zt.exports=cn()),zt.exports}var n=dn(),Et={},Or;function un(){if(Or)return Et;Or=1;var e=sn();return Et.createRoot=e.createRoot,Et.hydrateRoot=e.hydrateRoot,Et}var hn=un(),dt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Qe=typeof window>"u"||"Deno"in globalThis;function se(){}function fn(e,t){return typeof e=="function"?e(t):e}function Yt(e){return typeof e=="number"&&e>=0&&e!==1/0}function ms(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Je(e,t){return typeof e=="function"?e(t):e}function ie(e,t){return typeof e=="function"?e(t):e}function Pr(e,t){const{type:r="all",exact:s,fetchStatus:a,predicate:o,queryKey:i,stale:l}=e;if(i){if(s){if(t.queryHash!==gr(i,t.options))return!1}else if(!yt(t.queryKey,i))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||o&&!o(t))}function Tr(e,t){const{exact:r,status:s,predicate:a,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(r){if(ze(t.options.mutationKey)!==ze(o))return!1}else if(!yt(t.options.mutationKey,o))return!1}return!(s&&t.state.status!==s||a&&!a(t))}function gr(e,t){return((t==null?void 0:t.queryKeyHashFn)||ze)(e)}function ze(e){return JSON.stringify(e,(t,r)=>Xt(r)?Object.keys(r).sort().reduce((s,a)=>(s[a]=r[a],s),{}):r)}function yt(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>yt(e[r],t[r])):!1}function ps(e,t){if(e===t)return e;const r=Fr(e)&&Fr(t);if(r||Xt(e)&&Xt(t)){const s=r?e:Object.keys(e),a=s.length,o=r?t:Object.keys(t),i=o.length,l=r?[]:{};let d=0;for(let f=0;f<i;f++){const u=r?f:o[f];(!r&&s.includes(u)||r)&&e[u]===void 0&&t[u]===void 0?(l[u]=void 0,d++):(l[u]=ps(e[u],t[u]),l[u]===e[u]&&e[u]!==void 0&&d++)}return a===i&&d===a?e:l}return t}function Lt(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Fr(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Xt(e){if(!Ir(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Ir(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Ir(e){return Object.prototype.toString.call(e)==="[object Object]"}function mn(e){return new Promise(t=>{setTimeout(t,e)})}function Zt(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?ps(e,t):t}function pn(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function yn(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var xr=Symbol();function ys(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===xr?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Te,ke,Ve,ss,gn=(ss=class extends dt{constructor(){super();O(this,Te);O(this,ke);O(this,Ve);A(this,Ve,t=>{if(!Qe&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){c(this,ke)||this.setEventListener(c(this,Ve))}onUnsubscribe(){var t;this.hasListeners()||((t=c(this,ke))==null||t.call(this),A(this,ke,void 0))}setEventListener(t){var r;A(this,Ve,t),(r=c(this,ke))==null||r.call(this),A(this,ke,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){c(this,Te)!==t&&(A(this,Te,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof c(this,Te)=="boolean"?c(this,Te):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Te=new WeakMap,ke=new WeakMap,Ve=new WeakMap,ss),br=new gn,Ye,Ne,Xe,ns,xn=(ns=class extends dt{constructor(){super();O(this,Ye,!0);O(this,Ne);O(this,Xe);A(this,Xe,t=>{if(!Qe&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){c(this,Ne)||this.setEventListener(c(this,Xe))}onUnsubscribe(){var t;this.hasListeners()||((t=c(this,Ne))==null||t.call(this),A(this,Ne,void 0))}setEventListener(t){var r;A(this,Xe,t),(r=c(this,Ne))==null||r.call(this),A(this,Ne,t(this.setOnline.bind(this)))}setOnline(t){c(this,Ye)!==t&&(A(this,Ye,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return c(this,Ye)}},Ye=new WeakMap,Ne=new WeakMap,Xe=new WeakMap,ns),Dt=new xn;function er(){let e,t;const r=new Promise((a,o)=>{e=a,t=o});r.status="pending",r.catch(()=>{});function s(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{s({status:"fulfilled",value:a}),e(a)},r.reject=a=>{s({status:"rejected",reason:a}),t(a)},r}function bn(e){return Math.min(1e3*2**e,3e4)}function gs(e){return(e??"online")==="online"?Dt.isOnline():!0}var xs=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Kt(e){return e instanceof xs}function bs(e){let t=!1,r=0,s=!1,a;const o=er(),i=x=>{var m;s||(v(new xs(x)),(m=e.abort)==null||m.call(e))},l=()=>{t=!0},d=()=>{t=!1},f=()=>br.isFocused()&&(e.networkMode==="always"||Dt.isOnline())&&e.canRun(),u=()=>gs(e.networkMode)&&e.canRun(),h=x=>{var m;s||(s=!0,(m=e.onSuccess)==null||m.call(e,x),a==null||a(),o.resolve(x))},v=x=>{var m;s||(s=!0,(m=e.onError)==null||m.call(e,x),a==null||a(),o.reject(x))},w=()=>new Promise(x=>{var m;a=N=>{(s||f())&&x(N)},(m=e.onPause)==null||m.call(e)}).then(()=>{var x;a=void 0,s||(x=e.onContinue)==null||x.call(e)}),p=()=>{if(s)return;let x;const m=r===0?e.initialPromise:void 0;try{x=m??e.fn()}catch(N){x=Promise.reject(N)}Promise.resolve(x).then(h).catch(N=>{var L;if(s)return;const j=e.retry??(Qe?0:3),y=e.retryDelay??bn,C=typeof y=="function"?y(r,N):y,S=j===!0||typeof j=="number"&&r<j||typeof j=="function"&&j(r,N);if(t||!S){v(N);return}r++,(L=e.onFail)==null||L.call(e,r,N),mn(C).then(()=>f()?void 0:w()).then(()=>{t?v(N):p()})})};return{promise:o,cancel:i,continue:()=>(a==null||a(),o),cancelRetry:l,continueRetry:d,canStart:u,start:()=>(u()?p():w().then(p),o)}}var vn=e=>setTimeout(e,0);function wn(){let e=[],t=0,r=l=>{l()},s=l=>{l()},a=vn;const o=l=>{t?e.push(l):a(()=>{r(l)})},i=()=>{const l=e;e=[],l.length&&a(()=>{s(()=>{l.forEach(d=>{r(d)})})})};return{batch:l=>{let d;t++;try{d=l()}finally{t--,t||i()}return d},batchCalls:l=>(...d)=>{o(()=>{l(...d)})},schedule:o,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{s=l},setScheduler:l=>{a=l}}}var K=wn(),Fe,as,vs=(as=class{constructor(){O(this,Fe)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Yt(this.gcTime)&&A(this,Fe,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Qe?1/0:5*60*1e3))}clearGcTimeout(){c(this,Fe)&&(clearTimeout(c(this,Fe)),A(this,Fe,void 0))}},Fe=new WeakMap,as),Ze,et,re,Ie,W,xt,qe,ae,xe,os,jn=(os=class extends vs{constructor(t){super();O(this,ae);O(this,Ze);O(this,et);O(this,re);O(this,Ie);O(this,W);O(this,xt);O(this,qe);A(this,qe,!1),A(this,xt,t.defaultOptions),this.setOptions(t.options),this.observers=[],A(this,Ie,t.client),A(this,re,c(this,Ie).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,A(this,Ze,kn(this.options)),this.state=t.state??c(this,Ze),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=c(this,W))==null?void 0:t.promise}setOptions(t){this.options={...c(this,xt),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&c(this,re).remove(this)}setData(t,r){const s=Zt(this.state.data,t,this.options);return F(this,ae,xe).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){F(this,ae,xe).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,a;const r=(s=c(this,W))==null?void 0:s.promise;return(a=c(this,W))==null||a.cancel(t),r?r.then(se).catch(se):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(c(this,Ze))}isActive(){return this.observers.some(t=>ie(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===xr||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!ms(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=c(this,W))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=c(this,W))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),c(this,re).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(c(this,W)&&(c(this,qe)?c(this,W).cancel({revert:!0}):c(this,W).cancelRetry()),this.scheduleGc()),c(this,re).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||F(this,ae,xe).call(this,{type:"invalidate"})}fetch(t,r){var d,f,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(c(this,W))return c(this,W).continueRetry(),c(this,W).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(v=>v.options.queryFn);h&&this.setOptions(h.options)}const s=new AbortController,a=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(A(this,qe,!0),s.signal)})},o=()=>{const h=ys(this.options,r),v={client:c(this,Ie),queryKey:this.queryKey,meta:this.meta};return a(v),A(this,qe,!1),this.options.persister?this.options.persister(h,v,this):h(v)},i={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:c(this,Ie),state:this.state,fetchFn:o};a(i),(d=this.options.behavior)==null||d.onFetch(i,this),A(this,et,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=i.fetchOptions)==null?void 0:f.meta))&&F(this,ae,xe).call(this,{type:"fetch",meta:(u=i.fetchOptions)==null?void 0:u.meta});const l=h=>{var v,w,p,x;Kt(h)&&h.silent||F(this,ae,xe).call(this,{type:"error",error:h}),Kt(h)||((w=(v=c(this,re).config).onError)==null||w.call(v,h,this),(x=(p=c(this,re).config).onSettled)==null||x.call(p,this.state.data,h,this)),this.scheduleGc()};return A(this,W,bs({initialPromise:r==null?void 0:r.initialPromise,fn:i.fetchFn,abort:s.abort.bind(s),onSuccess:h=>{var v,w,p,x;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(m){l(m);return}(w=(v=c(this,re).config).onSuccess)==null||w.call(v,h,this),(x=(p=c(this,re).config).onSettled)==null||x.call(p,h,this.state.error,this),this.scheduleGc()},onError:l,onFail:(h,v)=>{F(this,ae,xe).call(this,{type:"failed",failureCount:h,error:v})},onPause:()=>{F(this,ae,xe).call(this,{type:"pause"})},onContinue:()=>{F(this,ae,xe).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),c(this,W).start()}},Ze=new WeakMap,et=new WeakMap,re=new WeakMap,Ie=new WeakMap,W=new WeakMap,xt=new WeakMap,qe=new WeakMap,ae=new WeakSet,xe=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...ws(s.data,this.options),fetchMeta:t.meta??null};case"success":return{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return Kt(a)&&a.revert&&c(this,et)?{...c(this,et),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),K.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),c(this,re).notify({query:this,type:"updated",action:t})})},os);function ws(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gs(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function kn(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var me,is,Nn=(is=class extends dt{constructor(t={}){super();O(this,me);this.config=t,A(this,me,new Map)}build(t,r,s){const a=r.queryKey,o=r.queryHash??gr(a,r);let i=this.get(o);return i||(i=new jn({client:t,queryKey:a,queryHash:o,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){c(this,me).has(t.queryHash)||(c(this,me).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=c(this,me).get(t.queryHash);r&&(t.destroy(),r===t&&c(this,me).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){K.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return c(this,me).get(t)}getAll(){return[...c(this,me).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>Pr(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>Pr(t,s)):r}notify(t){K.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){K.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){K.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},me=new WeakMap,is),pe,V,Me,ye,je,ls,En=(ls=class extends vs{constructor(t){super();O(this,ye);O(this,pe);O(this,V);O(this,Me);this.mutationId=t.mutationId,A(this,V,t.mutationCache),A(this,pe,[]),this.state=t.state||js(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){c(this,pe).includes(t)||(c(this,pe).push(t),this.clearGcTimeout(),c(this,V).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){A(this,pe,c(this,pe).filter(r=>r!==t)),this.scheduleGc(),c(this,V).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){c(this,pe).length||(this.state.status==="pending"?this.scheduleGc():c(this,V).remove(this))}continue(){var t;return((t=c(this,Me))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,i,l,d,f,u,h,v,w,p,x,m,N,j,y,C,S,L,_,E;const r=()=>{F(this,ye,je).call(this,{type:"continue"})};A(this,Me,bs({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(b,R)=>{F(this,ye,je).call(this,{type:"failed",failureCount:b,error:R})},onPause:()=>{F(this,ye,je).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>c(this,V).canRun(this)}));const s=this.state.status==="pending",a=!c(this,Me).canStart();try{if(s)r();else{F(this,ye,je).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(o=c(this,V).config).onMutate)==null?void 0:i.call(o,t,this));const R=await((d=(l=this.options).onMutate)==null?void 0:d.call(l,t));R!==this.state.context&&F(this,ye,je).call(this,{type:"pending",context:R,variables:t,isPaused:a})}const b=await c(this,Me).start();return await((u=(f=c(this,V).config).onSuccess)==null?void 0:u.call(f,b,t,this.state.context,this)),await((v=(h=this.options).onSuccess)==null?void 0:v.call(h,b,t,this.state.context)),await((p=(w=c(this,V).config).onSettled)==null?void 0:p.call(w,b,null,this.state.variables,this.state.context,this)),await((m=(x=this.options).onSettled)==null?void 0:m.call(x,b,null,t,this.state.context)),F(this,ye,je).call(this,{type:"success",data:b}),b}catch(b){try{throw await((j=(N=c(this,V).config).onError)==null?void 0:j.call(N,b,t,this.state.context,this)),await((C=(y=this.options).onError)==null?void 0:C.call(y,b,t,this.state.context)),await((L=(S=c(this,V).config).onSettled)==null?void 0:L.call(S,void 0,b,this.state.variables,this.state.context,this)),await((E=(_=this.options).onSettled)==null?void 0:E.call(_,void 0,b,t,this.state.context)),b}finally{F(this,ye,je).call(this,{type:"error",error:b})}}finally{c(this,V).runNext(this)}}},pe=new WeakMap,V=new WeakMap,Me=new WeakMap,ye=new WeakSet,je=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),K.batch(()=>{c(this,pe).forEach(s=>{s.onMutationUpdate(t)}),c(this,V).notify({mutation:this,type:"updated",action:t})})},ls);function js(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var be,oe,bt,cs,Cn=(cs=class extends dt{constructor(t={}){super();O(this,be);O(this,oe);O(this,bt);this.config=t,A(this,be,new Set),A(this,oe,new Map),A(this,bt,0)}build(t,r,s){const a=new En({mutationCache:this,mutationId:++Nt(this,bt)._,options:t.defaultMutationOptions(r),state:s});return this.add(a),a}add(t){c(this,be).add(t);const r=Ct(t);if(typeof r=="string"){const s=c(this,oe).get(r);s?s.push(t):c(this,oe).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(c(this,be).delete(t)){const r=Ct(t);if(typeof r=="string"){const s=c(this,oe).get(r);if(s)if(s.length>1){const a=s.indexOf(t);a!==-1&&s.splice(a,1)}else s[0]===t&&c(this,oe).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Ct(t);if(typeof r=="string"){const s=c(this,oe).get(r),a=s==null?void 0:s.find(o=>o.state.status==="pending");return!a||a===t}else return!0}runNext(t){var s;const r=Ct(t);if(typeof r=="string"){const a=(s=c(this,oe).get(r))==null?void 0:s.find(o=>o!==t&&o.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){K.batch(()=>{c(this,be).forEach(t=>{this.notify({type:"removed",mutation:t})}),c(this,be).clear(),c(this,oe).clear()})}getAll(){return Array.from(c(this,be))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>Tr(r,s))}findAll(t={}){return this.getAll().filter(r=>Tr(t,r))}notify(t){K.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return K.batch(()=>Promise.all(t.map(r=>r.continue().catch(se))))}},be=new WeakMap,oe=new WeakMap,bt=new WeakMap,cs);function Ct(e){var t;return(t=e.options.scope)==null?void 0:t.id}function qr(e){return{onFetch:(t,r)=>{var u,h,v,w,p;const s=t.options,a=(v=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:v.direction,o=((w=t.state.data)==null?void 0:w.pages)||[],i=((p=t.state.data)==null?void 0:p.pageParams)||[];let l={pages:[],pageParams:[]},d=0;const f=async()=>{let x=!1;const m=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?x=!0:t.signal.addEventListener("abort",()=>{x=!0}),t.signal)})},N=ys(t.options,t.fetchOptions),j=async(y,C,S)=>{if(x)return Promise.reject();if(C==null&&y.pages.length)return Promise.resolve(y);const L={client:t.client,queryKey:t.queryKey,pageParam:C,direction:S?"backward":"forward",meta:t.options.meta};m(L);const _=await N(L),{maxPages:E}=t.options,b=S?yn:pn;return{pages:b(y.pages,_,E),pageParams:b(y.pageParams,C,E)}};if(a&&o.length){const y=a==="backward",C=y?Rn:Mr,S={pages:o,pageParams:i},L=C(s,S);l=await j(S,L,y)}else{const y=e??o.length;do{const C=d===0?i[0]??s.initialPageParam:Mr(s,l);if(d>0&&C==null)break;l=await j(l,C),d++}while(d<y)}return l};t.options.persister?t.fetchFn=()=>{var x,m;return(m=(x=t.options).persister)==null?void 0:m.call(x,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=f}}}function Mr(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function Rn(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var H,Ee,Ce,tt,rt,Re,st,nt,ds,Sn=(ds=class{constructor(e={}){O(this,H);O(this,Ee);O(this,Ce);O(this,tt);O(this,rt);O(this,Re);O(this,st);O(this,nt);A(this,H,e.queryCache||new Nn),A(this,Ee,e.mutationCache||new Cn),A(this,Ce,e.defaultOptions||{}),A(this,tt,new Map),A(this,rt,new Map),A(this,Re,0)}mount(){Nt(this,Re)._++,c(this,Re)===1&&(A(this,st,br.subscribe(async e=>{e&&(await this.resumePausedMutations(),c(this,H).onFocus())})),A(this,nt,Dt.subscribe(async e=>{e&&(await this.resumePausedMutations(),c(this,H).onOnline())})))}unmount(){var e,t;Nt(this,Re)._--,c(this,Re)===0&&((e=c(this,st))==null||e.call(this),A(this,st,void 0),(t=c(this,nt))==null||t.call(this),A(this,nt,void 0))}isFetching(e){return c(this,H).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return c(this,Ee).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=c(this,H).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=c(this,H).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Je(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return c(this,H).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),a=c(this,H).get(s.queryHash),o=a==null?void 0:a.state.data,i=fn(t,o);if(i!==void 0)return c(this,H).build(this,s).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return K.batch(()=>c(this,H).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=c(this,H).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=c(this,H);K.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=c(this,H);return K.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=K.batch(()=>c(this,H).findAll(e).map(a=>a.cancel(r)));return Promise.all(s).then(se).catch(se)}invalidateQueries(e,t={}){return K.batch(()=>(c(this,H).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=K.batch(()=>c(this,H).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,r);return r.throwOnError||(o=o.catch(se)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(se)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=c(this,H).build(this,t);return r.isStaleByTime(Je(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(se).catch(se)}fetchInfiniteQuery(e){return e.behavior=qr(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(se).catch(se)}ensureInfiniteQueryData(e){return e.behavior=qr(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Dt.isOnline()?c(this,Ee).resumePausedMutations():Promise.resolve()}getQueryCache(){return c(this,H)}getMutationCache(){return c(this,Ee)}getDefaultOptions(){return c(this,Ce)}setDefaultOptions(e){A(this,Ce,e)}setQueryDefaults(e,t){c(this,tt).set(ze(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...c(this,tt).values()],r={};return t.forEach(s=>{yt(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){c(this,rt).set(ze(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...c(this,rt).values()],r={};return t.forEach(s=>{yt(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...c(this,Ce).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=gr(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===xr&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...c(this,Ce).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){c(this,H).clear(),c(this,Ee).clear()}},H=new WeakMap,Ee=new WeakMap,Ce=new WeakMap,tt=new WeakMap,rt=new WeakMap,Re=new WeakMap,st=new WeakMap,nt=new WeakMap,ds),X,I,vt,Y,Ue,at,Se,_e,wt,ot,it,$e,Be,Ae,lt,B,pt,tr,rr,sr,nr,ar,or,ir,ks,us,_n=(us=class extends dt{constructor(t,r){super();O(this,B);O(this,X);O(this,I);O(this,vt);O(this,Y);O(this,Ue);O(this,at);O(this,Se);O(this,_e);O(this,wt);O(this,ot);O(this,it);O(this,$e);O(this,Be);O(this,Ae);O(this,lt,new Set);this.options=r,A(this,X,t),A(this,_e,null),A(this,Se,er()),this.options.experimental_prefetchInRender||c(this,Se).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(c(this,I).addObserver(this),Ur(c(this,I),this.options)?F(this,B,pt).call(this):this.updateResult(),F(this,B,nr).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return lr(c(this,I),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return lr(c(this,I),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,F(this,B,ar).call(this),F(this,B,or).call(this),c(this,I).removeObserver(this)}setOptions(t){const r=this.options,s=c(this,I);if(this.options=c(this,X).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ie(this.options.enabled,c(this,I))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");F(this,B,ir).call(this),c(this,I).setOptions(this.options),r._defaulted&&!Lt(this.options,r)&&c(this,X).getQueryCache().notify({type:"observerOptionsUpdated",query:c(this,I),observer:this});const a=this.hasListeners();a&&$r(c(this,I),s,this.options,r)&&F(this,B,pt).call(this),this.updateResult(),a&&(c(this,I)!==s||ie(this.options.enabled,c(this,I))!==ie(r.enabled,c(this,I))||Je(this.options.staleTime,c(this,I))!==Je(r.staleTime,c(this,I)))&&F(this,B,tr).call(this);const o=F(this,B,rr).call(this);a&&(c(this,I)!==s||ie(this.options.enabled,c(this,I))!==ie(r.enabled,c(this,I))||o!==c(this,Ae))&&F(this,B,sr).call(this,o)}getOptimisticResult(t){const r=c(this,X).getQueryCache().build(c(this,X),t),s=this.createResult(r,t);return Ln(this,s)&&(A(this,Y,s),A(this,at,this.options),A(this,Ue,c(this,I).state)),s}getCurrentResult(){return c(this,Y)}trackResult(t,r){return new Proxy(t,{get:(s,a)=>(this.trackProp(a),r==null||r(a),Reflect.get(s,a))})}trackProp(t){c(this,lt).add(t)}getCurrentQuery(){return c(this,I)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=c(this,X).defaultQueryOptions(t),s=c(this,X).getQueryCache().build(c(this,X),r);return s.fetch().then(()=>this.createResult(s,r))}fetch(t){return F(this,B,pt).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),c(this,Y)))}createResult(t,r){var b;const s=c(this,I),a=this.options,o=c(this,Y),i=c(this,Ue),l=c(this,at),f=t!==s?t.state:c(this,vt),{state:u}=t;let h={...u},v=!1,w;if(r._optimisticResults){const R=this.hasListeners(),D=!R&&Ur(t,r),P=R&&$r(t,s,r,a);(D||P)&&(h={...h,...ws(u.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:x,status:m}=h;w=h.data;let N=!1;if(r.placeholderData!==void 0&&w===void 0&&m==="pending"){let R;o!=null&&o.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(R=o.data,N=!0):R=typeof r.placeholderData=="function"?r.placeholderData((b=c(this,it))==null?void 0:b.state.data,c(this,it)):r.placeholderData,R!==void 0&&(m="success",w=Zt(o==null?void 0:o.data,R,r),v=!0)}if(r.select&&w!==void 0&&!N)if(o&&w===(i==null?void 0:i.data)&&r.select===c(this,wt))w=c(this,ot);else try{A(this,wt,r.select),w=r.select(w),w=Zt(o==null?void 0:o.data,w,r),A(this,ot,w),A(this,_e,null)}catch(R){A(this,_e,R)}c(this,_e)&&(p=c(this,_e),w=c(this,ot),x=Date.now(),m="error");const j=h.fetchStatus==="fetching",y=m==="pending",C=m==="error",S=y&&j,L=w!==void 0,E={status:m,fetchStatus:h.fetchStatus,isPending:y,isSuccess:m==="success",isError:C,isInitialLoading:S,isLoading:S,data:w,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>f.dataUpdateCount||h.errorUpdateCount>f.errorUpdateCount,isFetching:j,isRefetching:j&&!y,isLoadingError:C&&!L,isPaused:h.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:C&&L,isStale:vr(t,r),refetch:this.refetch,promise:c(this,Se)};if(this.options.experimental_prefetchInRender){const R=q=>{E.status==="error"?q.reject(E.error):E.data!==void 0&&q.resolve(E.data)},D=()=>{const q=A(this,Se,E.promise=er());R(q)},P=c(this,Se);switch(P.status){case"pending":t.queryHash===s.queryHash&&R(P);break;case"fulfilled":(E.status==="error"||E.data!==P.value)&&D();break;case"rejected":(E.status!=="error"||E.error!==P.reason)&&D();break}}return E}updateResult(){const t=c(this,Y),r=this.createResult(c(this,I),this.options);if(A(this,Ue,c(this,I).state),A(this,at,this.options),c(this,Ue).data!==void 0&&A(this,it,c(this,I)),Lt(r,t))return;A(this,Y,r);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!c(this,lt).size)return!0;const i=new Set(o??c(this,lt));return this.options.throwOnError&&i.add("error"),Object.keys(c(this,Y)).some(l=>{const d=l;return c(this,Y)[d]!==t[d]&&i.has(d)})};F(this,B,ks).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&F(this,B,nr).call(this)}},X=new WeakMap,I=new WeakMap,vt=new WeakMap,Y=new WeakMap,Ue=new WeakMap,at=new WeakMap,Se=new WeakMap,_e=new WeakMap,wt=new WeakMap,ot=new WeakMap,it=new WeakMap,$e=new WeakMap,Be=new WeakMap,Ae=new WeakMap,lt=new WeakMap,B=new WeakSet,pt=function(t){F(this,B,ir).call(this);let r=c(this,I).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(se)),r},tr=function(){F(this,B,ar).call(this);const t=Je(this.options.staleTime,c(this,I));if(Qe||c(this,Y).isStale||!Yt(t))return;const s=ms(c(this,Y).dataUpdatedAt,t)+1;A(this,$e,setTimeout(()=>{c(this,Y).isStale||this.updateResult()},s))},rr=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(c(this,I)):this.options.refetchInterval)??!1},sr=function(t){F(this,B,or).call(this),A(this,Ae,t),!(Qe||ie(this.options.enabled,c(this,I))===!1||!Yt(c(this,Ae))||c(this,Ae)===0)&&A(this,Be,setInterval(()=>{(this.options.refetchIntervalInBackground||br.isFocused())&&F(this,B,pt).call(this)},c(this,Ae)))},nr=function(){F(this,B,tr).call(this),F(this,B,sr).call(this,F(this,B,rr).call(this))},ar=function(){c(this,$e)&&(clearTimeout(c(this,$e)),A(this,$e,void 0))},or=function(){c(this,Be)&&(clearInterval(c(this,Be)),A(this,Be,void 0))},ir=function(){const t=c(this,X).getQueryCache().build(c(this,X),this.options);if(t===c(this,I))return;const r=c(this,I);A(this,I,t),A(this,vt,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},ks=function(t){K.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(c(this,Y))}),c(this,X).getQueryCache().notify({query:c(this,I),type:"observerResultsUpdated"})})},us);function An(e,t){return ie(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Ur(e,t){return An(e,t)||e.state.data!==void 0&&lr(e,t,t.refetchOnMount)}function lr(e,t,r){if(ie(t.enabled,e)!==!1){const s=typeof r=="function"?r(e):r;return s==="always"||s!==!1&&vr(e,t)}return!1}function $r(e,t,r,s){return(e!==t||ie(s.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&vr(e,r)}function vr(e,t){return ie(t.enabled,e)!==!1&&e.isStaleByTime(Je(t.staleTime,e))}function Ln(e,t){return!Lt(e.getCurrentResult(),t)}var Le,De,Z,ve,we,Rt,cr,hs,Dn=(hs=class extends dt{constructor(r,s){super();O(this,we);O(this,Le);O(this,De);O(this,Z);O(this,ve);A(this,Le,r),this.setOptions(s),this.bindMethods(),F(this,we,Rt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const s=this.options;this.options=c(this,Le).defaultMutationOptions(r),Lt(this.options,s)||c(this,Le).getMutationCache().notify({type:"observerOptionsUpdated",mutation:c(this,Z),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&ze(s.mutationKey)!==ze(this.options.mutationKey)?this.reset():((a=c(this,Z))==null?void 0:a.state.status)==="pending"&&c(this,Z).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=c(this,Z))==null||r.removeObserver(this)}onMutationUpdate(r){F(this,we,Rt).call(this),F(this,we,cr).call(this,r)}getCurrentResult(){return c(this,De)}reset(){var r;(r=c(this,Z))==null||r.removeObserver(this),A(this,Z,void 0),F(this,we,Rt).call(this),F(this,we,cr).call(this)}mutate(r,s){var a;return A(this,ve,s),(a=c(this,Z))==null||a.removeObserver(this),A(this,Z,c(this,Le).getMutationCache().build(c(this,Le),this.options)),c(this,Z).addObserver(this),c(this,Z).execute(r)}},Le=new WeakMap,De=new WeakMap,Z=new WeakMap,ve=new WeakMap,we=new WeakSet,Rt=function(){var s;const r=((s=c(this,Z))==null?void 0:s.state)??js();A(this,De,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},cr=function(r){K.batch(()=>{var s,a,o,i,l,d,f,u;if(c(this,ve)&&this.hasListeners()){const h=c(this,De).variables,v=c(this,De).context;(r==null?void 0:r.type)==="success"?((a=(s=c(this,ve)).onSuccess)==null||a.call(s,r.data,h,v),(i=(o=c(this,ve)).onSettled)==null||i.call(o,r.data,null,h,v)):(r==null?void 0:r.type)==="error"&&((d=(l=c(this,ve)).onError)==null||d.call(l,r.error,h,v),(u=(f=c(this,ve)).onSettled)==null||u.call(f,void 0,r.error,h,v))}this.listeners.forEach(h=>{h(c(this,De))})})},hs),Ns=k.createContext(void 0),ge=e=>{const t=k.useContext(Ns);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},On=({client:e,children:t})=>(k.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),n.jsx(Ns.Provider,{value:e,children:t})),Es=k.createContext(!1),Pn=()=>k.useContext(Es);Es.Provider;function Tn(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Fn=k.createContext(Tn()),In=()=>k.useContext(Fn);function Cs(e,t){return typeof e=="function"?e(...t):!!e}function dr(){}var qn=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Mn=e=>{k.useEffect(()=>{e.clearReset()},[e])},Un=({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(a&&e.data===void 0||Cs(r,[e.error,s])),$n=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...r)=>Math.max(t(...r),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},Bn=(e,t)=>e.isLoading&&e.isFetching&&!t,Hn=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Br=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Qn(e,t,r){var h,v,w,p,x;const s=ge(),a=Pn(),o=In(),i=s.defaultQueryOptions(e);(v=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||v.call(h,i),i._optimisticResults=a?"isRestoring":"optimistic",$n(i),qn(i,o),Mn(o);const l=!s.getQueryCache().get(i.queryHash),[d]=k.useState(()=>new t(s,i)),f=d.getOptimisticResult(i),u=!a&&e.subscribed!==!1;if(k.useSyncExternalStore(k.useCallback(m=>{const N=u?d.subscribe(K.batchCalls(m)):dr;return d.updateResult(),N},[d,u]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),k.useEffect(()=>{d.setOptions(i)},[i,d]),Hn(i,f))throw Br(i,d,o);if(Un({result:f,errorResetBoundary:o,throwOnError:i.throwOnError,query:s.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw f.error;if((p=(w=s.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||p.call(w,i,f),i.experimental_prefetchInRender&&!Qe&&Bn(f,a)){const m=l?Br(i,d,o):(x=s.getQueryCache().get(i.queryHash))==null?void 0:x.promise;m==null||m.catch(dr).finally(()=>{d.updateResult()})}return i.notifyOnChangeProps?f:d.trackResult(f)}function We(e,t){return Qn(e,_n)}function ct(e,t){const r=ge(),[s]=k.useState(()=>new Dn(r,e));k.useEffect(()=>{s.setOptions(e)},[s,e]);const a=k.useSyncExternalStore(k.useCallback(i=>s.subscribe(K.batchCalls(i)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),o=k.useCallback((i,l)=>{s.mutate(i,l).catch(dr)},[s]);if(a.error&&Cs(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}function Rs(e,t){return function(){return e.apply(t,arguments)}}const{toString:zn}=Object.prototype,{getPrototypeOf:wr}=Object,{iterator:Tt,toStringTag:Ss}=Symbol,Ft=(e=>t=>{const r=zn.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ce=e=>(e=e.toLowerCase(),t=>Ft(t)===e),It=e=>t=>typeof t===e,{isArray:ut}=Array,gt=It("undefined");function Kn(e){return e!==null&&!gt(e)&&e.constructor!==null&&!gt(e.constructor)&&ee(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _s=ce("ArrayBuffer");function Wn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_s(e.buffer),t}const Gn=It("string"),ee=It("function"),As=It("number"),qt=e=>e!==null&&typeof e=="object",Jn=e=>e===!0||e===!1,St=e=>{if(Ft(e)!=="object")return!1;const t=wr(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ss in e)&&!(Tt in e)},Vn=ce("Date"),Yn=ce("File"),Xn=ce("Blob"),Zn=ce("FileList"),ea=e=>qt(e)&&ee(e.pipe),ta=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ee(e.append)&&((t=Ft(e))==="formdata"||t==="object"&&ee(e.toString)&&e.toString()==="[object FormData]"))},ra=ce("URLSearchParams"),[sa,na,aa,oa]=["ReadableStream","Request","Response","Headers"].map(ce),ia=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jt(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),ut(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{const o=r?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let l;for(s=0;s<i;s++)l=o[s],t.call(null,e[l],l,e)}}function Ls(e,t){t=t.toLowerCase();const r=Object.keys(e);let s=r.length,a;for(;s-- >0;)if(a=r[s],t===a.toLowerCase())return a;return null}const Pe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ds=e=>!gt(e)&&e!==Pe;function ur(){const{caseless:e}=Ds(this)&&this||{},t={},r=(s,a)=>{const o=e&&Ls(t,a)||a;St(t[o])&&St(s)?t[o]=ur(t[o],s):St(s)?t[o]=ur({},s):ut(s)?t[o]=s.slice():t[o]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&jt(arguments[s],r);return t}const la=(e,t,r,{allOwnKeys:s}={})=>(jt(t,(a,o)=>{r&&ee(a)?e[o]=Rs(a,r):e[o]=a},{allOwnKeys:s}),e),ca=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),da=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},ua=(e,t,r,s)=>{let a,o,i;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)i=a[o],(!s||s(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=r!==!1&&wr(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},ha=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},fa=e=>{if(!e)return null;if(ut(e))return e;let t=e.length;if(!As(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},ma=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&wr(Uint8Array)),pa=(e,t)=>{const s=(e&&e[Tt]).call(e);let a;for(;(a=s.next())&&!a.done;){const o=a.value;t.call(e,o[0],o[1])}},ya=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},ga=ce("HTMLFormElement"),xa=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,a){return s.toUpperCase()+a}),Hr=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ba=ce("RegExp"),Os=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};jt(r,(a,o)=>{let i;(i=t(a,o,e))!==!1&&(s[o]=i||a)}),Object.defineProperties(e,s)},va=e=>{Os(e,(t,r)=>{if(ee(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(ee(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},wa=(e,t)=>{const r={},s=a=>{a.forEach(o=>{r[o]=!0})};return ut(e)?s(e):s(String(e).split(t)),r},ja=()=>{},ka=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Na(e){return!!(e&&ee(e.append)&&e[Ss]==="FormData"&&e[Tt])}const Ea=e=>{const t=new Array(10),r=(s,a)=>{if(qt(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[a]=s;const o=ut(s)?[]:{};return jt(s,(i,l)=>{const d=r(i,a+1);!gt(d)&&(o[l]=d)}),t[a]=void 0,o}}return s};return r(e,0)},Ca=ce("AsyncFunction"),Ra=e=>e&&(qt(e)||ee(e))&&ee(e.then)&&ee(e.catch),Ps=((e,t)=>e?setImmediate:t?((r,s)=>(Pe.addEventListener("message",({source:a,data:o})=>{a===Pe&&o===r&&s.length&&s.shift()()},!1),a=>{s.push(a),Pe.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ee(Pe.postMessage)),Sa=typeof queueMicrotask<"u"?queueMicrotask.bind(Pe):typeof process<"u"&&process.nextTick||Ps,_a=e=>e!=null&&ee(e[Tt]),g={isArray:ut,isArrayBuffer:_s,isBuffer:Kn,isFormData:ta,isArrayBufferView:Wn,isString:Gn,isNumber:As,isBoolean:Jn,isObject:qt,isPlainObject:St,isReadableStream:sa,isRequest:na,isResponse:aa,isHeaders:oa,isUndefined:gt,isDate:Vn,isFile:Yn,isBlob:Xn,isRegExp:ba,isFunction:ee,isStream:ea,isURLSearchParams:ra,isTypedArray:ma,isFileList:Zn,forEach:jt,merge:ur,extend:la,trim:ia,stripBOM:ca,inherits:da,toFlatObject:ua,kindOf:Ft,kindOfTest:ce,endsWith:ha,toArray:fa,forEachEntry:pa,matchAll:ya,isHTMLForm:ga,hasOwnProperty:Hr,hasOwnProp:Hr,reduceDescriptors:Os,freezeMethods:va,toObjectSet:wa,toCamelCase:xa,noop:ja,toFiniteNumber:ka,findKey:Ls,global:Pe,isContextDefined:Ds,isSpecCompliantForm:Na,toJSONObject:Ea,isAsyncFn:Ca,isThenable:Ra,setImmediate:Ps,asap:Sa,isIterable:_a};function T(e,t,r,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}g.inherits(T,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g.toJSONObject(this.config),code:this.code,status:this.status}}});const Ts=T.prototype,Fs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Fs[e]={value:e}});Object.defineProperties(T,Fs);Object.defineProperty(Ts,"isAxiosError",{value:!0});T.from=(e,t,r,s,a,o)=>{const i=Object.create(Ts);return g.toFlatObject(e,i,function(d){return d!==Error.prototype},l=>l!=="isAxiosError"),T.call(i,e.message,t,r,s,a),i.cause=e,i.name=e.name,o&&Object.assign(i,o),i};const Aa=null;function hr(e){return g.isPlainObject(e)||g.isArray(e)}function Is(e){return g.endsWith(e,"[]")?e.slice(0,-2):e}function Qr(e,t,r){return e?e.concat(t).map(function(a,o){return a=Is(a),!r&&o?"["+a+"]":a}).join(r?".":""):t}function La(e){return g.isArray(e)&&!e.some(hr)}const Da=g.toFlatObject(g,{},null,function(t){return/^is[A-Z]/.test(t)});function Mt(e,t,r){if(!g.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=g.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,m){return!g.isUndefined(m[x])});const s=r.metaTokens,a=r.visitor||u,o=r.dots,i=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&g.isSpecCompliantForm(t);if(!g.isFunction(a))throw new TypeError("visitor must be a function");function f(p){if(p===null)return"";if(g.isDate(p))return p.toISOString();if(!d&&g.isBlob(p))throw new T("Blob is not supported. Use a Buffer instead.");return g.isArrayBuffer(p)||g.isTypedArray(p)?d&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,x,m){let N=p;if(p&&!m&&typeof p=="object"){if(g.endsWith(x,"{}"))x=s?x:x.slice(0,-2),p=JSON.stringify(p);else if(g.isArray(p)&&La(p)||(g.isFileList(p)||g.endsWith(x,"[]"))&&(N=g.toArray(p)))return x=Is(x),N.forEach(function(y,C){!(g.isUndefined(y)||y===null)&&t.append(i===!0?Qr([x],C,o):i===null?x:x+"[]",f(y))}),!1}return hr(p)?!0:(t.append(Qr(m,x,o),f(p)),!1)}const h=[],v=Object.assign(Da,{defaultVisitor:u,convertValue:f,isVisitable:hr});function w(p,x){if(!g.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(p),g.forEach(p,function(N,j){(!(g.isUndefined(N)||N===null)&&a.call(t,N,g.isString(j)?j.trim():j,x,v))===!0&&w(N,x?x.concat(j):[j])}),h.pop()}}if(!g.isObject(e))throw new TypeError("data must be an object");return w(e),t}function zr(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function jr(e,t){this._pairs=[],e&&Mt(e,this,t)}const qs=jr.prototype;qs.append=function(t,r){this._pairs.push([t,r])};qs.toString=function(t){const r=t?function(s){return t.call(this,s,zr)}:zr;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Oa(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ms(e,t,r){if(!t)return e;const s=r&&r.encode||Oa;g.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let o;if(a?o=a(t,r):o=g.isURLSearchParams(t)?t.toString():new jr(t,r).toString(s),o){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class Kr{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){g.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Us={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pa=typeof URLSearchParams<"u"?URLSearchParams:jr,Ta=typeof FormData<"u"?FormData:null,Fa=typeof Blob<"u"?Blob:null,Ia={isBrowser:!0,classes:{URLSearchParams:Pa,FormData:Ta,Blob:Fa},protocols:["http","https","file","blob","url","data"]},kr=typeof window<"u"&&typeof document<"u",fr=typeof navigator=="object"&&navigator||void 0,qa=kr&&(!fr||["ReactNative","NativeScript","NS"].indexOf(fr.product)<0),Ma=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ua=kr&&window.location.href||"http://localhost",$a=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kr,hasStandardBrowserEnv:qa,hasStandardBrowserWebWorkerEnv:Ma,navigator:fr,origin:Ua},Symbol.toStringTag,{value:"Module"})),G={...$a,...Ia};function Ba(e,t){return Mt(e,new G.classes.URLSearchParams,Object.assign({visitor:function(r,s,a,o){return G.isNode&&g.isBuffer(r)?(this.append(s,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function Ha(e){return g.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Qa(e){const t={},r=Object.keys(e);let s;const a=r.length;let o;for(s=0;s<a;s++)o=r[s],t[o]=e[o];return t}function $s(e){function t(r,s,a,o){let i=r[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),d=o>=r.length;return i=!i&&g.isArray(a)?a.length:i,d?(g.hasOwnProp(a,i)?a[i]=[a[i],s]:a[i]=s,!l):((!a[i]||!g.isObject(a[i]))&&(a[i]=[]),t(r,s,a[i],o)&&g.isArray(a[i])&&(a[i]=Qa(a[i])),!l)}if(g.isFormData(e)&&g.isFunction(e.entries)){const r={};return g.forEachEntry(e,(s,a)=>{t(Ha(s),a,r,0)}),r}return null}function za(e,t,r){if(g.isString(e))try{return(t||JSON.parse)(e),g.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const kt={transitional:Us,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",a=s.indexOf("application/json")>-1,o=g.isObject(t);if(o&&g.isHTMLForm(t)&&(t=new FormData(t)),g.isFormData(t))return a?JSON.stringify($s(t)):t;if(g.isArrayBuffer(t)||g.isBuffer(t)||g.isStream(t)||g.isFile(t)||g.isBlob(t)||g.isReadableStream(t))return t;if(g.isArrayBufferView(t))return t.buffer;if(g.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Ba(t,this.formSerializer).toString();if((l=g.isFileList(t))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Mt(l?{"files[]":t}:t,d&&new d,this.formSerializer)}}return o||a?(r.setContentType("application/json",!1),za(t)):t}],transformResponse:[function(t){const r=this.transitional||kt.transitional,s=r&&r.forcedJSONParsing,a=this.responseType==="json";if(g.isResponse(t)||g.isReadableStream(t))return t;if(t&&g.isString(t)&&(s&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?T.from(l,T.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:G.classes.FormData,Blob:G.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g.forEach(["delete","get","head","post","put","patch"],e=>{kt.headers[e]={}});const Ka=g.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wa=e=>{const t={};let r,s,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),s=i.substring(a+1).trim(),!(!r||t[r]&&Ka[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},Wr=Symbol("internals");function mt(e){return e&&String(e).trim().toLowerCase()}function _t(e){return e===!1||e==null?e:g.isArray(e)?e.map(_t):String(e)}function Ga(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const Ja=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Wt(e,t,r,s,a){if(g.isFunction(s))return s.call(this,t,r);if(a&&(t=r),!!g.isString(t)){if(g.isString(s))return t.indexOf(s)!==-1;if(g.isRegExp(s))return s.test(t)}}function Va(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function Ya(e,t){const r=g.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(a,o,i){return this[s].call(this,t,a,o,i)},configurable:!0})})}let te=class{constructor(t){t&&this.set(t)}set(t,r,s){const a=this;function o(l,d,f){const u=mt(d);if(!u)throw new Error("header name must be a non-empty string");const h=g.findKey(a,u);(!h||a[h]===void 0||f===!0||f===void 0&&a[h]!==!1)&&(a[h||d]=_t(l))}const i=(l,d)=>g.forEach(l,(f,u)=>o(f,u,d));if(g.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(g.isString(t)&&(t=t.trim())&&!Ja(t))i(Wa(t),r);else if(g.isObject(t)&&g.isIterable(t)){let l={},d,f;for(const u of t){if(!g.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[f=u[0]]=(d=l[f])?g.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}i(l,r)}else t!=null&&o(r,t,s);return this}get(t,r){if(t=mt(t),t){const s=g.findKey(this,t);if(s){const a=this[s];if(!r)return a;if(r===!0)return Ga(a);if(g.isFunction(r))return r.call(this,a,s);if(g.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=mt(t),t){const s=g.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||Wt(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let a=!1;function o(i){if(i=mt(i),i){const l=g.findKey(s,i);l&&(!r||Wt(s,s[l],l,r))&&(delete s[l],a=!0)}}return g.isArray(t)?t.forEach(o):o(t),a}clear(t){const r=Object.keys(this);let s=r.length,a=!1;for(;s--;){const o=r[s];(!t||Wt(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const r=this,s={};return g.forEach(this,(a,o)=>{const i=g.findKey(s,o);if(i){r[i]=_t(a),delete r[o];return}const l=t?Va(o):String(o).trim();l!==o&&delete r[o],r[l]=_t(a),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return g.forEach(this,(s,a)=>{s!=null&&s!==!1&&(r[a]=t&&g.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Wr]=this[Wr]={accessors:{}}).accessors,a=this.prototype;function o(i){const l=mt(i);s[l]||(Ya(a,i),s[l]=!0)}return g.isArray(t)?t.forEach(o):o(t),this}};te.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);g.reduceDescriptors(te.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});g.freezeMethods(te);function Gt(e,t){const r=this||kt,s=t||r,a=te.from(s.headers);let o=s.data;return g.forEach(e,function(l){o=l.call(r,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function Bs(e){return!!(e&&e.__CANCEL__)}function ht(e,t,r){T.call(this,e??"canceled",T.ERR_CANCELED,t,r),this.name="CanceledError"}g.inherits(ht,T,{__CANCEL__:!0});function Hs(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new T("Request failed with status code "+r.status,[T.ERR_BAD_REQUEST,T.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Xa(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Za(e,t){e=e||10;const r=new Array(e),s=new Array(e);let a=0,o=0,i;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),u=s[o];i||(i=f),r[a]=d,s[a]=f;let h=o,v=0;for(;h!==a;)v+=r[h++],h=h%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),f-i<t)return;const w=u&&f-u;return w?Math.round(v*1e3/w):void 0}}function eo(e,t){let r=0,s=1e3/t,a,o;const i=(f,u=Date.now())=>{r=u,a=null,o&&(clearTimeout(o),o=null),e.apply(null,f)};return[(...f)=>{const u=Date.now(),h=u-r;h>=s?i(f,u):(a=f,o||(o=setTimeout(()=>{o=null,i(a)},s-h)))},()=>a&&i(a)]}const Ot=(e,t,r=3)=>{let s=0;const a=Za(50,250);return eo(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,d=i-s,f=a(d),u=i<=l;s=i;const h={loaded:i,total:l,progress:l?i/l:void 0,bytes:d,rate:f||void 0,estimated:f&&l&&u?(l-i)/f:void 0,event:o,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},r)},Gr=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},Jr=e=>(...t)=>g.asap(()=>e(...t)),to=G.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,G.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(G.origin),G.navigator&&/(msie|trident)/i.test(G.navigator.userAgent)):()=>!0,ro=G.hasStandardBrowserEnv?{write(e,t,r,s,a,o){const i=[e+"="+encodeURIComponent(t)];g.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),g.isString(s)&&i.push("path="+s),g.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function so(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function no(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Qs(e,t,r){let s=!so(t);return e&&(s||r==!1)?no(e,t):t}const Vr=e=>e instanceof te?{...e}:e;function Ke(e,t){t=t||{};const r={};function s(f,u,h,v){return g.isPlainObject(f)&&g.isPlainObject(u)?g.merge.call({caseless:v},f,u):g.isPlainObject(u)?g.merge({},u):g.isArray(u)?u.slice():u}function a(f,u,h,v){if(g.isUndefined(u)){if(!g.isUndefined(f))return s(void 0,f,h,v)}else return s(f,u,h,v)}function o(f,u){if(!g.isUndefined(u))return s(void 0,u)}function i(f,u){if(g.isUndefined(u)){if(!g.isUndefined(f))return s(void 0,f)}else return s(void 0,u)}function l(f,u,h){if(h in t)return s(f,u);if(h in e)return s(void 0,f)}const d={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(f,u,h)=>a(Vr(f),Vr(u),h,!0)};return g.forEach(Object.keys(Object.assign({},e,t)),function(u){const h=d[u]||a,v=h(e[u],t[u],u);g.isUndefined(v)&&h!==l||(r[u]=v)}),r}const zs=e=>{const t=Ke({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:l}=t;t.headers=i=te.from(i),t.url=Ms(Qs(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let d;if(g.isFormData(r)){if(G.hasStandardBrowserEnv||G.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((d=i.getContentType())!==!1){const[f,...u]=d?d.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([f||"multipart/form-data",...u].join("; "))}}if(G.hasStandardBrowserEnv&&(s&&g.isFunction(s)&&(s=s(t)),s||s!==!1&&to(t.url))){const f=a&&o&&ro.read(o);f&&i.set(a,f)}return t},ao=typeof XMLHttpRequest<"u",oo=ao&&function(e){return new Promise(function(r,s){const a=zs(e);let o=a.data;const i=te.from(a.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:f}=a,u,h,v,w,p;function x(){w&&w(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let m=new XMLHttpRequest;m.open(a.method.toUpperCase(),a.url,!0),m.timeout=a.timeout;function N(){if(!m)return;const y=te.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:y,config:e,request:m};Hs(function(_){r(_),x()},function(_){s(_),x()},S),m=null}"onloadend"in m?m.onloadend=N:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(N)},m.onabort=function(){m&&(s(new T("Request aborted",T.ECONNABORTED,e,m)),m=null)},m.onerror=function(){s(new T("Network Error",T.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let C=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const S=a.transitional||Us;a.timeoutErrorMessage&&(C=a.timeoutErrorMessage),s(new T(C,S.clarifyTimeoutError?T.ETIMEDOUT:T.ECONNABORTED,e,m)),m=null},o===void 0&&i.setContentType(null),"setRequestHeader"in m&&g.forEach(i.toJSON(),function(C,S){m.setRequestHeader(S,C)}),g.isUndefined(a.withCredentials)||(m.withCredentials=!!a.withCredentials),l&&l!=="json"&&(m.responseType=a.responseType),f&&([v,p]=Ot(f,!0),m.addEventListener("progress",v)),d&&m.upload&&([h,w]=Ot(d),m.upload.addEventListener("progress",h),m.upload.addEventListener("loadend",w)),(a.cancelToken||a.signal)&&(u=y=>{m&&(s(!y||y.type?new ht(null,e,m):y),m.abort(),m=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const j=Xa(a.url);if(j&&G.protocols.indexOf(j)===-1){s(new T("Unsupported protocol "+j+":",T.ERR_BAD_REQUEST,e));return}m.send(o||null)})},io=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,a;const o=function(f){if(!a){a=!0,l();const u=f instanceof Error?f:this.reason;s.abort(u instanceof T?u:new ht(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,o(new T(`timeout ${t} of ms exceeded`,T.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(o):f.removeEventListener("abort",o)}),e=null)};e.forEach(f=>f.addEventListener("abort",o));const{signal:d}=s;return d.unsubscribe=()=>g.asap(l),d}},lo=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,a;for(;s<r;)a=s+t,yield e.slice(s,a),s=a},co=async function*(e,t){for await(const r of uo(e))yield*lo(r,t)},uo=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},Yr=(e,t,r,s)=>{const a=co(e,t);let o=0,i,l=d=>{i||(i=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:f,value:u}=await a.next();if(f){l(),d.close();return}let h=u.byteLength;if(r){let v=o+=h;r(v)}d.enqueue(new Uint8Array(u))}catch(f){throw l(f),f}},cancel(d){return l(d),a.return()}},{highWaterMark:2})},Ut=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ks=Ut&&typeof ReadableStream=="function",ho=Ut&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Ws=(e,...t)=>{try{return!!e(...t)}catch{return!1}},fo=Ks&&Ws(()=>{let e=!1;const t=new Request(G.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Xr=64*1024,mr=Ks&&Ws(()=>g.isReadableStream(new Response("").body)),Pt={stream:mr&&(e=>e.body)};Ut&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Pt[t]&&(Pt[t]=g.isFunction(e[t])?r=>r[t]():(r,s)=>{throw new T(`Response type '${t}' is not supported`,T.ERR_NOT_SUPPORT,s)})})})(new Response);const mo=async e=>{if(e==null)return 0;if(g.isBlob(e))return e.size;if(g.isSpecCompliantForm(e))return(await new Request(G.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(g.isArrayBufferView(e)||g.isArrayBuffer(e))return e.byteLength;if(g.isURLSearchParams(e)&&(e=e+""),g.isString(e))return(await ho(e)).byteLength},po=async(e,t)=>{const r=g.toFiniteNumber(e.getContentLength());return r??mo(t)},yo=Ut&&(async e=>{let{url:t,method:r,data:s,signal:a,cancelToken:o,timeout:i,onDownloadProgress:l,onUploadProgress:d,responseType:f,headers:u,withCredentials:h="same-origin",fetchOptions:v}=zs(e);f=f?(f+"").toLowerCase():"text";let w=io([a,o&&o.toAbortSignal()],i),p;const x=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let m;try{if(d&&fo&&r!=="get"&&r!=="head"&&(m=await po(u,s))!==0){let S=new Request(t,{method:"POST",body:s,duplex:"half"}),L;if(g.isFormData(s)&&(L=S.headers.get("content-type"))&&u.setContentType(L),S.body){const[_,E]=Gr(m,Ot(Jr(d)));s=Yr(S.body,Xr,_,E)}}g.isString(h)||(h=h?"include":"omit");const N="credentials"in Request.prototype;p=new Request(t,{...v,signal:w,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:N?h:void 0});let j=await fetch(p);const y=mr&&(f==="stream"||f==="response");if(mr&&(l||y&&x)){const S={};["status","statusText","headers"].forEach(b=>{S[b]=j[b]});const L=g.toFiniteNumber(j.headers.get("content-length")),[_,E]=l&&Gr(L,Ot(Jr(l),!0))||[];j=new Response(Yr(j.body,Xr,_,()=>{E&&E(),x&&x()}),S)}f=f||"text";let C=await Pt[g.findKey(Pt,f)||"text"](j,e);return!y&&x&&x(),await new Promise((S,L)=>{Hs(S,L,{data:C,headers:te.from(j.headers),status:j.status,statusText:j.statusText,config:e,request:p})})}catch(N){throw x&&x(),N&&N.name==="TypeError"&&/Load failed|fetch/i.test(N.message)?Object.assign(new T("Network Error",T.ERR_NETWORK,e,p),{cause:N.cause||N}):T.from(N,N&&N.code,e,p)}}),pr={http:Aa,xhr:oo,fetch:yo};g.forEach(pr,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Zr=e=>`- ${e}`,go=e=>g.isFunction(e)||e===null||e===!1,Gs={getAdapter:e=>{e=g.isArray(e)?e:[e];const{length:t}=e;let r,s;const a={};for(let o=0;o<t;o++){r=e[o];let i;if(s=r,!go(r)&&(s=pr[(i=String(r)).toLowerCase()],s===void 0))throw new T(`Unknown adapter '${i}'`);if(s)break;a[i||"#"+o]=s}if(!s){const o=Object.entries(a).map(([l,d])=>`adapter ${l} `+(d===!1?"is not supported by the environment":"is not available in the build"));let i=t?o.length>1?`since :
`+o.map(Zr).join(`
`):" "+Zr(o[0]):"as no adapter specified";throw new T("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:pr};function Jt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ht(null,e)}function es(e){return Jt(e),e.headers=te.from(e.headers),e.data=Gt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Gs.getAdapter(e.adapter||kt.adapter)(e).then(function(s){return Jt(e),s.data=Gt.call(e,e.transformResponse,s),s.headers=te.from(s.headers),s},function(s){return Bs(s)||(Jt(e),s&&s.response&&(s.response.data=Gt.call(e,e.transformResponse,s.response),s.response.headers=te.from(s.response.headers))),Promise.reject(s)})}const Js="1.9.0",$t={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{$t[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const ts={};$t.transitional=function(t,r,s){function a(o,i){return"[Axios v"+Js+"] Transitional option '"+o+"'"+i+(s?". "+s:"")}return(o,i,l)=>{if(t===!1)throw new T(a(i," has been removed"+(r?" in "+r:"")),T.ERR_DEPRECATED);return r&&!ts[i]&&(ts[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(o,i,l):!0}};$t.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function xo(e,t,r){if(typeof e!="object")throw new T("options must be an object",T.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const o=s[a],i=t[o];if(i){const l=e[o],d=l===void 0||i(l,o,e);if(d!==!0)throw new T("option "+o+" must be "+d,T.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new T("Unknown option "+o,T.ERR_BAD_OPTION)}}const At={assertOptions:xo,validators:$t},ue=At.validators;let He=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Kr,response:new Kr}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ke(this.defaults,r);const{transitional:s,paramsSerializer:a,headers:o}=r;s!==void 0&&At.assertOptions(s,{silentJSONParsing:ue.transitional(ue.boolean),forcedJSONParsing:ue.transitional(ue.boolean),clarifyTimeoutError:ue.transitional(ue.boolean)},!1),a!=null&&(g.isFunction(a)?r.paramsSerializer={serialize:a}:At.assertOptions(a,{encode:ue.function,serialize:ue.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),At.assertOptions(r,{baseUrl:ue.spelling("baseURL"),withXsrfToken:ue.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&g.merge(o.common,o[r.method]);o&&g.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),r.headers=te.concat(i,o);const l=[];let d=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(d=d&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const f=[];this.interceptors.response.forEach(function(x){f.push(x.fulfilled,x.rejected)});let u,h=0,v;if(!d){const p=[es.bind(this),void 0];for(p.unshift.apply(p,l),p.push.apply(p,f),v=p.length,u=Promise.resolve(r);h<v;)u=u.then(p[h++],p[h++]);return u}v=l.length;let w=r;for(h=0;h<v;){const p=l[h++],x=l[h++];try{w=p(w)}catch(m){x.call(this,m);break}}try{u=es.call(this,w)}catch(p){return Promise.reject(p)}for(h=0,v=f.length;h<v;)u=u.then(f[h++],f[h++]);return u}getUri(t){t=Ke(this.defaults,t);const r=Qs(t.baseURL,t.url,t.allowAbsoluteUrls);return Ms(r,t.params,t.paramsSerializer)}};g.forEach(["delete","get","head","options"],function(t){He.prototype[t]=function(r,s){return this.request(Ke(s||{},{method:t,url:r,data:(s||{}).data}))}});g.forEach(["post","put","patch"],function(t){function r(s){return function(o,i,l){return this.request(Ke(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}He.prototype[t]=r(),He.prototype[t+"Form"]=r(!0)});let bo=class Vs{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const s=this;this.promise.then(a=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](a);s._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(l=>{s.subscribe(l),o=l}).then(a);return i.cancel=function(){s.unsubscribe(o)},i},t(function(o,i,l){s.reason||(s.reason=new ht(o,i,l),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Vs(function(a){t=a}),cancel:t}}};function vo(e){return function(r){return e.apply(null,r)}}function wo(e){return g.isObject(e)&&e.isAxiosError===!0}const yr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(yr).forEach(([e,t])=>{yr[t]=e});function Ys(e){const t=new He(e),r=Rs(He.prototype.request,t);return g.extend(r,He.prototype,t,{allOwnKeys:!0}),g.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return Ys(Ke(e,a))},r}const z=Ys(kt);z.Axios=He;z.CanceledError=ht;z.CancelToken=bo;z.isCancel=Bs;z.VERSION=Js;z.toFormData=Mt;z.AxiosError=T;z.Cancel=z.CanceledError;z.all=function(t){return Promise.all(t)};z.spread=vo;z.isAxiosError=wo;z.mergeConfig=Ke;z.AxiosHeaders=te;z.formToJSON=e=>$s(g.isHTMLForm(e)?new FormData(e):e);z.getAdapter=Gs.getAdapter;z.HttpStatusCode=yr;z.default=z;const{Axios:Ni,AxiosError:Ei,CanceledError:Ci,isCancel:Ri,CancelToken:Si,VERSION:_i,all:Ai,Cancel:Li,isAxiosError:Di,spread:Oi,toFormData:Pi,AxiosHeaders:Ti,HttpStatusCode:Fi,formToJSON:Ii,getAdapter:qi,mergeConfig:Mi}=z,jo="https://looplist.onrender.com/api/v1",Q=z.create({baseURL:jo,headers:{"Content-Type":"application/json"}});Q.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Q.interceptors.response.use(e=>e,async e=>{var r,s,a,o,i;console.error("API Error:",{url:(r=e.config)==null?void 0:r.url,method:(s=e.config)==null?void 0:s.method,status:(a=e.response)==null?void 0:a.status,data:(o=e.response)==null?void 0:o.data,message:e.message});const t=e.config;return e.response?(e.response.status===401&&!t._retry&&(t._retry=!0,localStorage.removeItem("token"),window.location.href="/#/login"),e.response.status===404&&console.error("Resource not found:",(i=e.config)==null?void 0:i.url)):e.request?console.error("No response received:",e.request):console.error("Request setup error:",e.message),Promise.reject(e)});const ko=async(e,t)=>{const r=new FormData;return r.append("username",e),r.append("password",t),(await Q.post("/auth/login",r,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data},No=async e=>(await Q.post("/auth/signup",e)).data,Vt=async()=>{try{return(await Q.get("/users/me")).data}catch{return null}},Xs=k.createContext(),Eo=({children:e})=>{const[t,r]=k.useState(null),[s,a]=k.useState(!0),[o,i]=k.useState(null);k.useEffect(()=>{(async()=>{try{if(localStorage.getItem("token")){const w=await Vt();r(w)}}catch(v){console.error("Authentication error:",v),localStorage.removeItem("token")}finally{a(!1)}})()},[]);const u={user:t,loading:s,error:o,login:async(h,v)=>{var w,p;i(null);try{const x=await ko(h,v);localStorage.setItem("token",x.access_token);const m=await Vt();return r(m),m}catch(x){throw i(((p=(w=x.response)==null?void 0:w.data)==null?void 0:p.detail)||"Login failed"),x}},signup:async h=>{var v,w;i(null);try{const p=await No(h);localStorage.setItem("token",p.access_token);const x=await Vt();return r(x),x}catch(p){throw i(((w=(v=p.response)==null?void 0:v.data)==null?void 0:w.detail)||"Signup failed"),p}},logout:()=>{localStorage.removeItem("token"),r(null)},isAuthenticated:!!t};return n.jsx(Xs.Provider,{value:u,children:e})},Oe=()=>{const e=k.useContext(Xs);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},M=({children:e,type:t="button",variant:r="primary",size:s="md",className:a="",disabled:o=!1,onClick:i,...l})=>{const d="btn inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 relative z-20",f={primary:"btn-primary focus:ring-primary-500",secondary:"btn-secondary focus:ring-secondary-500",outline:"btn-outline focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300"},u={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-5 py-2.5 text-lg"},h=o?"opacity-50 cursor-not-allowed":"cursor-pointer",v=`${d} ${f[r]} ${u[s]} ${h} ${a}`;return n.jsx("button",{type:t,className:v,disabled:o,onClick:i,...l,children:e})},Co=()=>{const{user:e,isAuthenticated:t,logout:r}=Oe(),s=le(),[a,o]=k.useState(!1),[i,l]=k.useState(!1);k.useEffect(()=>{const u=localStorage.getItem("darkMode")==="true",h=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,v=u||h;l(v),v?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[]);const d=()=>{const u=!i;l(u),localStorage.setItem("darkMode",u.toString()),u?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},f=()=>{r(),s("/login")};return n.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm w-full",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsxs("div",{className:"flex justify-between items-center py-4",children:[n.jsx($,{to:"/",className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:"LoopList"}),n.jsxs("nav",{className:"hidden md:flex items-center space-x-6",children:[n.jsx($,{to:"/",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",children:"Home"}),t?n.jsxs(n.Fragment,{children:[n.jsx($,{to:"/dashboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",children:"Dashboard"}),n.jsx($,{to:"/friends",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",children:"Friends"}),n.jsx($,{to:"/leaderboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",children:"Leaderboard"})]}):n.jsx($,{to:"/leaderboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",children:"Leaderboard"}),n.jsx("button",{onClick:d,className:"p-2 rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none","aria-label":"Toggle Dark Mode",children:i?n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),t?n.jsx(M,{variant:"outline",size:"sm",onClick:f,children:"Logout"}):n.jsxs(n.Fragment,{children:[n.jsx($,{to:"/login",children:n.jsx(M,{variant:"outline",size:"sm",children:"Login"})}),n.jsx($,{to:"/signup",children:n.jsx(M,{size:"sm",children:"Sign Up"})})]})]}),n.jsx("button",{className:"md:hidden text-gray-700 dark:text-gray-300",onClick:()=>o(!a),children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),a&&n.jsx("div",{className:"md:hidden py-4 border-t border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex flex-col space-y-4",children:[n.jsx($,{to:"/",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",onClick:()=>o(!1),children:"Home"}),t?n.jsxs(n.Fragment,{children:[n.jsx($,{to:"/dashboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",onClick:()=>o(!1),children:"Dashboard"}),n.jsx($,{to:"/friends",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",onClick:()=>o(!1),children:"Friends"}),n.jsx($,{to:"/leaderboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",onClick:()=>o(!1),children:"Leaderboard"})]}):n.jsx($,{to:"/leaderboard",className:"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400",onClick:()=>o(!1),children:"Leaderboard"}),n.jsxs("button",{onClick:()=>{d(),o(!1)},className:"flex items-center text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Toggle Dark Mode",children:[n.jsx("span",{className:"mr-2",children:i?"Light Mode":"Dark Mode"}),i?n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})]}),t?n.jsx(M,{variant:"outline",size:"sm",onClick:()=>{f(),o(!1)},children:"Logout"}):n.jsxs(n.Fragment,{children:[n.jsx($,{to:"/login",onClick:()=>o(!1),children:n.jsx(M,{variant:"outline",size:"sm",className:"w-full",children:"Login"})}),n.jsx($,{to:"/signup",onClick:()=>o(!1),children:n.jsx(M,{size:"sm",className:"w-full",children:"Sign Up"})})]})]})})]})})},Ro=()=>{const e=new Date().getFullYear();return n.jsx("footer",{className:"bg-white dark:bg-gray-800 shadow-inner mt-auto",children:n.jsxs("div",{className:"container mx-auto px-4 py-6",children:[n.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center",children:n.jsx("div",{className:"mb-4 md:mb-0",children:n.jsx($,{to:"/",className:"text-xl font-bold text-primary-600 dark:text-primary-400",children:"LoopList"})})}),n.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:["© ",e," LoopList. All rights reserved."]})]})})},So=async(e=0,t=10)=>(await Q.get("/public/leaderboard",{params:{skip:e,limit:t}})).data.map(a=>a._id&&!a.id?{...a,id:a._id}:a),_o=async(e=0,t=10)=>(await Q.get("/public/top-streaks",{params:{skip:e,limit:t}})).data.map(a=>a._id&&!a.id?{...a,id:a._id}:a),Nr=async(e,t)=>{var s,a,o;if(console.group("REACTION API CALL"),console.log("=== REACTION API CALL START ==="),!e||e==="undefined")throw console.error("Invalid loop ID detected:",e),console.groupEnd(),new Error("Invalid loop ID: Cannot react to a loop with undefined ID");const r="❤️‍🔥";console.log(`Loop ID: ${e} (type: ${typeof e})`),console.log(`Emoji: ${r}`);try{console.log(`Making reaction request for loop ID: ${e}`),console.log("Request URL:",`/public/loops/${e}/react`),console.log("Request body:",{emoji:r});const i=await Q.post(`/public/loops/${e}/react`,{emoji:r});if(console.log("Reaction API response status:",i.status),console.log("Reaction API response headers:",i.headers),console.log("Reaction API response data:",i.data),console.log("Reaction API response data type:",typeof i.data),console.log("Response data structure:",JSON.stringify(i.data,null,2)),i.data===void 0||i.data===null)throw console.error("API returned empty response data"),console.groupEnd(),new Error("API returned empty response data");if(typeof i.data=="number")return console.log("Returning numeric response:",i.data),console.log("=== REACTION API CALL END ==="),console.groupEnd(),i.data;if(typeof i.data=="object"&&i.data[r]!==void 0){const l=i.data[r];return console.log(`Returning object response for emoji ${r}:`,l),l===0?(console.log("API returned 0 for a reaction we just added, returning 1 instead"),console.log("=== REACTION API CALL END ==="),console.groupEnd(),1):(console.log("=== REACTION API CALL END ==="),console.groupEnd(),l)}return console.warn("Could not determine reaction count from API response, using fallback value"),console.log("Full response data:",JSON.stringify(i.data)),console.log("=== REACTION API CALL END ==="),console.groupEnd(),1}catch(i){throw console.error("Error in reactToLoop API call:",i),console.error("Error details:",{message:i.message,status:(s=i.response)==null?void 0:s.status,statusText:(a=i.response)==null?void 0:a.statusText,responseData:(o=i.response)==null?void 0:o.data}),console.log("=== REACTION API CALL END WITH ERROR ==="),console.groupEnd(),i}},Zs=async e=>{if(!e||e==="undefined")throw new Error("Invalid loop ID: Cannot clone a loop with undefined ID");try{console.log("Making clone request for loop ID:",e);const t=await Q.post(`/public/loops/${e}/clone`);if(console.log("Clone API response:",t),!t.data)throw new Error("API returned empty response data");const r=t.data;return r._id&&!r.id?{...r,id:r._id}:r}catch(t){throw console.error("Error in cloneLoop API call:",t),t}},U=({children:e,className:t="",...r})=>n.jsx("div",{className:`card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 ${t}`,...r,children:e}),rs="🟩",Ao="🟥",Lo="✅",Er=({loop:e,size:t="md",showLabel:r=!1})=>{const s=()=>{try{if(e.status==="completed")return"completed";const l=new Date(e.start_date),d=new Date;if(d.setHours(0,0,0,0),l>d)return console.log("Loop hasn't started yet, marking as active"),"active";if(e.frequency_type==="x_times_per_week"){const f=new Date(d),u=d.getDay();if(f.setDate(d.getDate()-u),f.setHours(0,0,0,0),l<=d&&e.status==="active"&&(e.current_streak>0||e.longest_streak>0))return console.log("Loop has completions, marking as active"),"active"}return e.current_streak===0&&e.status==="active"?"broken":(e.status==="active"&&e.current_streak>0,"active")}catch(l){return console.error("Error determining loop state:",l),"active"}},a=()=>{switch(s()){case"active":return rs;case"broken":return Ao;case"completed":return Lo;default:return rs}},o=()=>{switch(s()){case"active":return"Active";case"broken":return"Broken";case"completed":return"Completed";default:return"Active"}},i={sm:"text-lg",md:"text-2xl",lg:"text-3xl",xl:"text-4xl"};return n.jsxs("div",{className:"flex items-center",title:`Loop state: ${o()}`,children:[n.jsx("div",{className:`${i[t]||"text-2xl"} mr-2`,children:a()}),r&&n.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:o()})]})},Do=e=>{if(!e)return"";const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`},Oo=()=>Do(new Date),Po=async(e=null,t=0,r=10)=>{var s;try{console.log(`Fetching loops with status: ${e||"all"}, skip: ${t}, limit: ${r}`);const a={skip:t,limit:r};e&&(a.status=e);const o=await Q.get("/loops",{params:a});return console.log("Raw API response:",o.data),console.log("API response headers:",o.headers),console.log("API request config:",o.config),o.data&&Array.isArray(o.data)?(console.log(`Found ${o.data.length} loops`),o.data.length>0?(console.log("First loop sample:",JSON.stringify(o.data[0],null,2)),console.log("User ID in first loop:",o.data[0].user_id)):console.log("No loops returned from API")):console.log("API response is not an array:",typeof o.data),o.data.map(l=>{const d={...l};return l._id&&!l.id&&(d.id=l._id),l.reaction_count!==void 0?(d.reaction_count=Number(l.reaction_count),console.log(`Loop ${l._id||l.id} reaction_count: ${d.reaction_count}`)):(d.reaction_count=0,console.log(`Loop ${l._id||l.id} has no reaction_count, setting to 0`)),d})}catch(a){throw console.error("Error fetching loops:",a),console.error("Error details:",(s=a.response)==null?void 0:s.data),a}},To=async e=>{const r=(await Q.get(`/loops/${e}`)).data,s={...r};return r&&r._id&&!r.id&&(s.id=r._id),r&&r.reaction_count!==void 0?(s.reaction_count=Number(r.reaction_count),console.log(`Loop ${r._id||r.id} reaction_count: ${s.reaction_count}`)):r&&(s.reaction_count=0,console.log(`Loop ${r._id||r.id} has no reaction_count, setting to 0`)),s},Fo=async e=>(await Q.post("/loops",e)).data,Io=async(e,t)=>(await Q.put(`/loops/${e}`,t)).data,qo=async e=>(await Q.put(`/loops/${e}`,{status:"archived"})).data,Mo=async(e,t=null)=>{var a;if(!e)throw new Error("Loop ID is required");const r=Oo();console.log(`Today's date in local timezone: ${r}`);const s={completion_date:t||r};console.log(`Sending completion request for loop ID: ${e}`),console.log("Sending completion data:",s);try{const i=(await Q.post(`/loops/${e}/complete`,s)).data;return i&&i._id&&!i.id?{...i,id:i._id}:i}catch(o){throw console.error(`Error completing loop ${e}:`,((a=o.response)==null?void 0:a.data)||o.message),o}},Uo=async(e,t=null,r=null)=>{const s={};return t&&(s.start_date=t),r&&(s.end_date=r),(await Q.get(`/loops/${e}/calendar`,{params:s})).data},$o=async e=>{try{return(await Q.get(`/loops/${e}/count`)).data}catch{return console.log("Count endpoint failed, falling back to calendar data"),(await Q.get(`/loops/${e}/calendar`)).data.length}},Bo=(e=null,t=0,r=10)=>We({queryKey:["loops",{status:e,page:t,limit:r}],queryFn:()=>Po(e,t*r,r),staleTime:1e3*60*5,keepPreviousData:!0}),Cr=e=>We({queryKey:["loop",e],queryFn:()=>To(e),enabled:!!e,staleTime:1e3*60*5}),Ho=()=>{const e=ge();return ct({mutationFn:Fo,onSuccess:()=>{e.invalidateQueries({queryKey:["loops"]})}})},Qo=()=>{const e=ge();return ct({mutationFn:({loopId:t,data:r})=>Io(t,r),onSuccess:t=>{e.invalidateQueries({queryKey:["loops"]});const r=t&&(t.id||t._id);r&&e.invalidateQueries({queryKey:["loop",r]})}})},zo=()=>{const e=ge();return ct({mutationFn:qo,onSuccess:()=>{e.invalidateQueries({queryKey:["loops"]})}})},en=()=>{const e=ge();return ct({mutationFn:({loopId:t,date:r})=>Mo(t,r),onSuccess:t=>{e.invalidateQueries({queryKey:["loops"]});const r=t&&(t.id||t._id);r&&(e.invalidateQueries({queryKey:["loop",r]}),e.invalidateQueries({queryKey:["loop-calendar",r]}),e.invalidateQueries({queryKey:["completion-count",r]}))},onError:(t,r)=>{const{loopId:s}=r;s&&(e.invalidateQueries({queryKey:["completion-count",s]}),e.invalidateQueries({queryKey:["loop-calendar",s]}))}})},Ko=(e,t=null,r=null)=>We({queryKey:["loop-calendar",e,{startDate:t,endDate:r}],queryFn:()=>Uo(e,t,r),enabled:!!e,staleTime:1e3*60*5}),Bt=e=>We({queryKey:["completion-count",e],queryFn:()=>$o(e),enabled:!!e,staleTime:1e3*60*5}),he="❤️‍🔥",Wo=({loop:e,onClone:t})=>{const[r,s]=k.useState(!1),[a,o]=k.useState(null),[i,l]=k.useState(!1),[d,f]=k.useState(0),u=k.useRef(0);le();const{data:h=0}=Bt((e==null?void 0:e.id)||(e==null?void 0:e._id));if(!e)return n.jsx(U,{className:"h-full flex flex-col items-center justify-center p-6",children:n.jsx("p",{className:"text-gray-500",children:"Loop data not available"})});const{_id:v,id:w,title:p,current_streak:x=0,longest_streak:m=0,frequency_type:N,frequency_details:j={},user_username:y="Anonymous",clone_count:C=0,visibility:S="public",icon:L}=e,_=w||v;k.useEffect(()=>{console.log("Loop in useEffect:",e),console.log("Loop reaction_count type:",typeof e.reaction_count),console.log("Loop reaction_count value:",e.reaction_count),console.log("Loop object keys:",Object.keys(e)),console.log("Loop object values:",Object.values(e));const D=Number(e.reaction_count||0);console.log("Setting reaction count:",D,"(original value:",e.reaction_count,")"),d!==D&&(f(D),u.current=D,console.log(`[DEBUG] Initialized reactionCountRef.current to ${D}`))},[e,e.reaction_count]),k.useEffect(()=>{console.log(`[DEBUG] PublicLoopCard reaction count changed: ${d} for loop ${_}`),u.current=d,console.log(`[DEBUG] Updated reactionCountRef.current to ${u.current}`);const D=document.getElementById("debug-reaction-count");D&&(D.setAttribute("data-count",d.toString()),D.textContent=`Current reaction count: ${d}`)},[d,_]);const E=()=>{try{switch(N){case"daily":return"Every day";case"weekly":return j&&j.days_of_week?`${j.days_of_week.length} days per week`:"Weekly";case"specific_days":if(j&&j.days_of_week){const D=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return j.days_of_week.map(q=>D[q-1]).join(", ")}return"Specific days";case"every_n_days":return j&&j.every_n_days?`Every ${j.every_n_days} days`:"Every N days";default:return"Custom"}}catch(D){return console.error("Error formatting frequency text:",D),"Custom schedule"}},b=async()=>{console.group("PUBLICLOOPCARD REACTION HANDLER"),console.log("=== REACTION HANDLER START ==="),console.log("Initial state:",{loopId:_,currentReactionCount:d,isReacting:r,selectedEmoji:a});try{if(!_){console.error("Invalid loop ID for reaction"),console.groupEnd(),alert("Error: Cannot react to loop with invalid ID");return}s(!0),o(he),console.log("Set isReacting to true and selectedEmoji to",he);const D=d;f(J=>{const Ge=J+1;return console.log(`Incrementing local reaction count: ${J} -> ${Ge}`),u.current=Ge,console.log(`[DEBUG] Updated reactionCountRef.current to ${Ge} during increment`),Ge}),console.log(`Calling reactToLoop API with loopId: ${_}`);const P=await Nr(_,he);if(console.log("Reaction API result:",P),typeof P=="number")console.log(`Setting reaction count from API numeric result: ${P}`),P===0?(console.log("API returned 0 for a reaction we just added, keeping incremented count"),u.current<1&&(u.current=1,console.log("[DEBUG] Forced reactionCountRef.current to 1 since API returned 0"))):(f(P),u.current=P,console.log(`[DEBUG] Updated reactionCountRef.current to ${P} from API result`));else if(P&&typeof P=="object"&&P[he]!==void 0){const J=P[he];console.log(`Setting reaction count from API object result: ${J}`),J===0?(console.log("API returned 0 for a reaction we just added, keeping incremented count"),u.current<1&&(u.current=1,console.log("[DEBUG] Forced reactionCountRef.current to 1 since API returned 0"))):(f(J),u.current=J,console.log(`[DEBUG] Updated reactionCountRef.current to ${J} from API object result`))}else console.log("API result format not recognized, keeping local increment");let q;typeof P=="number"?q=P===0?D+1:P:P&&typeof P=="object"&&P[he]!==void 0?q=P[he]===0?D+1:P[he]:q=D+1,console.log(`Storing current reaction count for timeout: ${q}`),u.current=d,setTimeout(()=>{console.log("Timeout callback executing, resetting UI state"),s(!1),o(null);const J=u.current;console.log(`Checking reaction count in timeout: current=${J}, stored=${q}`),J===0&&q>0?(console.log(`Current count is 0 but should be at least 1, setting to ${q}`),f(q),u.current=q,console.log(`[DEBUG] Forced reactionCountRef.current to ${q} in timeout`)):J!==q&&q>0&&(console.log(`Reaction count changed during timeout, resetting to ${q}`),f(q),u.current=q,console.log(`[DEBUG] Updated reactionCountRef.current to ${q} in timeout`)),console.log("Final reaction count after API call:",q)},1500),console.log("=== REACTION HANDLER END ==="),console.groupEnd()}catch(D){console.error("Error reacting to loop:",D),f(P=>{const q=Math.max(0,P-1);return console.log(`Error occurred, reverting count: ${P} -> ${q}`),q}),alert(`Error reacting to loop: ${D.message||"Unknown error"}`),s(!1),o(null),console.log("=== REACTION HANDLER END WITH ERROR ==="),console.groupEnd()}},R=async()=>{l(!0);try{await t(_)}finally{l(!1)}};return n.jsxs(U,{className:"h-full flex flex-col p-5 mb-6",children:[n.jsxs("div",{id:"debug-reaction-count",className:"hidden","data-count":d.toString(),children:["Current reaction count: ",d]}),n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(Er,{loop:e}),L&&n.jsx("div",{className:"mr-3 text-2xl",children:L}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold",children:p}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["by ",y]}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:E()})]})]}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsxs("div",{className:"flex items-center mb-1",children:[S==="public"&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 mr-2",children:"Public"}),S==="friends_only"&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 mr-2",children:"Friends"})]}),N==="x_times_per_week"?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:h}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"times total"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:x}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"day streak"})]})]})]}),n.jsx("div",{className:"mb-4",children:n.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[C," ",C===1?"person":"people"," cloned this loop"]})}),n.jsx("div",{className:"mb-4",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:n.jsxs("button",{onClick:b,disabled:r,className:`px-3 py-1.5 rounded-full text-sm flex items-center ${a===he?"bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200":"bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"} transition-colors`,"data-reaction-count":d,"data-loop-reaction-count":e.reaction_count,children:[n.jsx("span",{children:he}),n.jsx("span",{className:"text-xs font-medium ml-1",children:d})]})})}),n.jsx("div",{className:"mt-auto pt-4",children:n.jsx(M,{variant:"outline",size:"sm",className:"w-full",onClick:R,disabled:i,children:i?"Cloning...":"Clone this loop"})})]})},Go=()=>{const{isAuthenticated:e}=Oe(),[t,r]=k.useState(0),[s,a]=k.useState([]),o=20,i=le(),l=ge(),d=k.useRef(null),[f,u]=k.useState(!0),{data:h,isLoading:v,error:w,isFetching:p}=We({queryKey:["leaderboard",t],queryFn:()=>So(t*o,o),staleTime:1e3*60*5,enabled:e,keepPreviousData:!0});k.useEffect(()=>{h&&(console.log("Loops data received in Home:",h),h.length>0&&h.forEach((y,C)=>{console.log(`Loop ${C} reaction_counts:`,y.reaction_counts)}),h.length<o&&u(!1),a(t===0?h:y=>[...y,...h]))},[h,t,o]);const x=k.useCallback(y=>{const[C]=y;C.isIntersecting&&f&&!p&&e&&r(S=>S+1)},[f,p,e]);k.useEffect(()=>{const y={root:null,rootMargin:"20px",threshold:0},C=new IntersectionObserver(x,y);return d.current&&C.observe(d.current),()=>{d.current&&C.unobserve(d.current)}},[x]);const m=async y=>{var C,S,L;if(!e){i("/login");return}if(!y||y==="undefined"){console.error("Invalid loop ID:",y),alert("Error: Cannot clone loop with invalid ID");return}try{console.log("Cloning loop with ID:",y);const _=await Zs(y);if(console.log("Clone result:",_),!_||!_.id&&!_._id)throw new Error("Invalid response: Missing loop ID in response");return alert("Loop cloned successfully! Check your dashboard."),l.invalidateQueries(["leaderboard"]),!0}catch(_){return console.error("Error cloning loop:",_),_.name==="TypeError"&&_.message.includes("Cannot read properties of undefined")?(console.error("API response is undefined or invalid"),alert("Error: Server returned an invalid response. Please try again later.")):((C=_.response)==null?void 0:C.status)===404?alert("Error: Loop not found or not available for cloning."):((S=_.response)==null?void 0:S.status)===403||((L=_.response)==null?void 0:L.status)===401?alert("Error: You are not authorized to clone this loop. Please log in again."):alert(`Error: ${_.message||"Failed to clone loop"}`),!1}},N=()=>n.jsxs(n.Fragment,{children:[n.jsxs("section",{className:"py-12 md:py-20 text-center",children:[n.jsxs("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Build Micro-Habits with ",n.jsx("span",{className:"text-primary-600 dark:text-primary-400",children:"Visual Progress"})]}),n.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto",children:"LoopList helps you track daily habits and build streaks with optional public accountability."}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[n.jsx($,{to:"/signup",children:n.jsx(M,{size:"lg",children:"Get Started"})}),n.jsx($,{to:"/login",children:n.jsx(M,{variant:"outline",size:"lg",children:"Log In"})})]})]}),n.jsxs("section",{className:"py-12",children:[n.jsx("h2",{className:"text-3xl font-bold mb-12 text-center",children:"How It Works"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[n.jsxs(U,{children:[n.jsx("div",{className:"text-4xl mb-4 text-primary-600 dark:text-primary-400",children:"🔄"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Create Loops"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Define micro-habits with flexible frequency options: daily, specific days, or custom patterns."})]}),n.jsxs(U,{children:[n.jsx("div",{className:"text-4xl mb-4 text-primary-600 dark:text-primary-400",children:"🔥"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Build Streaks"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Track your progress visually and maintain your streak. Don't break the chain!"})]}),n.jsxs(U,{children:[n.jsx("div",{className:"text-4xl mb-4 text-primary-600 dark:text-primary-400",children:"🌎"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Share Publicly"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Optionally make your loops public for accountability and to inspire others."})]})]})]}),n.jsx("section",{className:"py-12 text-center",children:n.jsxs(U,{className:"bg-gradient-to-r from-primary-500 to-secondary-500 text-white",children:[n.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4",children:"Ready to Build Better Habits?"}),n.jsx("p",{className:"mb-6 text-white/90",children:"Join thousands of users who are building consistent habits with LoopList."}),n.jsx($,{to:"/signup",children:n.jsx(M,{variant:"outline",className:"border-white text-white hover:bg-white hover:text-primary-600",children:"Sign Up for Free"})})]})})]}),j=()=>{if(v&&t===0)return n.jsx("div",{className:"flex justify-center items-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});if(w&&t===0)return n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Public Loops"}),n.jsx("p",{children:w.message||"An error occurred while loading public loops."}),n.jsx(M,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:"Try Again"})]});const y=s||[];return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold",children:"Public Loop Boards"}),n.jsx($,{to:"/loops/create",children:n.jsxs(M,{size:"sm",children:[n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Create Loop"]})})]}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Check out what others are working on. Get inspired, cheer them on with emoji reactions, or clone a loop to try it yourself!"}),y.length===0?n.jsxs(U,{className:"text-center py-12",children:[n.jsx("div",{className:"text-4xl mb-4",children:"🏆"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Public Loops Yet"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Be the first to create a public loop and inspire others!"}),n.jsx($,{to:"/loops/create",children:n.jsx(M,{children:"Create a Public Loop"})})]}):n.jsx("div",{className:"space-y-0",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[y.map(C=>n.jsx(Wo,{loop:C,onClone:m},C.id||C._id)),f&&n.jsx("div",{ref:d,className:"flex justify-center py-4",children:p&&n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}),!f&&y.length>0&&n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:n.jsx("p",{children:"You've reached the end of the feed"})})]})})]})};return n.jsx("div",{className:"w-full max-w-5xl mx-auto",children:e?j():N()})},ne=k.forwardRef(({label:e,id:t,type:r="text",placeholder:s="",error:a="",className:o="",required:i=!1,...l},d)=>n.jsxs("div",{className:"mb-4",children:[e&&n.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,i&&n.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n.jsx("input",{ref:d,id:t,type:r,placeholder:s,className:`input ${a?"border-red-500 focus:ring-red-500":""} ${o}`,"aria-invalid":a?"true":"false",...l}),a&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-500",children:a})]}));ne.displayName="Input";const Jo=()=>{const[e,t]=k.useState(""),[r,s]=k.useState(""),[a,o]=k.useState({}),[i,l]=k.useState(!1),{login:d}=Oe(),f=le(),u=()=>{const v={};return e||(v.email="Email is required"),r||(v.password="Password is required"),o(v),Object.keys(v).length===0},h=async v=>{var w,p;if(v.preventDefault(),!!u()){l(!0);try{await d(e,r),f("/dashboard")}catch(x){o({form:((p=(w=x.response)==null?void 0:w.data)==null?void 0:p.detail)||"Login failed. Please check your credentials."})}finally{l(!1)}}};return n.jsxs(U,{className:"max-w-md mx-auto",children:[n.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Log In"}),a.form&&n.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:a.form}),n.jsxs("form",{onSubmit:h,children:[n.jsx(ne,{label:"Email",id:"email",type:"email",value:e,onChange:v=>t(v.target.value),error:a.email,required:!0}),n.jsx(ne,{label:"Password",id:"password",type:"password",value:r,onChange:v=>s(v.target.value),error:a.password,required:!0}),n.jsx(M,{type:"submit",className:"w-full mt-4",disabled:i,children:i?"Logging in...":"Log In"})]}),n.jsx("div",{className:"mt-6 text-center text-sm",children:n.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Don't have an account?"," ",n.jsx($,{to:"/signup",className:"text-primary-600 dark:text-primary-400 hover:underline",children:"Sign up"})]})})]})},Vo=()=>{const{isAuthenticated:e}=Oe(),t=le();return k.useEffect(()=>{e&&t("/dashboard")},[e,t]),n.jsxs("div",{className:"max-w-md mx-auto py-12",children:[n.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Welcome Back"}),n.jsx(Jo,{})]})},Yo=()=>{const[e,t]=k.useState({email:"",username:"",password:"",confirmPassword:""}),[r,s]=k.useState({}),[a,o]=k.useState(!1),{signup:i}=Oe(),l=le(),d=h=>{const{name:v,value:w}=h.target;t(p=>({...p,[v]:w}))},f=()=>{const h={},{email:v,username:w,password:p,confirmPassword:x}=e;return v?/\S+@\S+\.\S+/.test(v)||(h.email="Email is invalid"):h.email="Email is required",w?w.length<3&&(h.username="Username must be at least 3 characters"):h.username="Username is required",p?p.length<6&&(h.password="Password must be at least 6 characters"):h.password="Password is required",p!==x&&(h.confirmPassword="Passwords do not match"),s(h),Object.keys(h).length===0},u=async h=>{var v,w;if(h.preventDefault(),!!f()){o(!0);try{const{confirmPassword:p,...x}=e;await i(x),l("/dashboard")}catch(p){s({form:((w=(v=p.response)==null?void 0:v.data)==null?void 0:w.detail)||"Signup failed. Please try again."})}finally{o(!1)}}};return n.jsxs(U,{className:"max-w-md mx-auto",children:[n.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Create an Account"}),r.form&&n.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:r.form}),n.jsxs("form",{onSubmit:u,children:[n.jsx(ne,{label:"Email",id:"email",name:"email",type:"email",value:e.email,onChange:d,error:r.email,required:!0}),n.jsx(ne,{label:"Username",id:"username",name:"username",type:"text",value:e.username,onChange:d,error:r.username,required:!0}),n.jsx(ne,{label:"Password",id:"password",name:"password",type:"password",value:e.password,onChange:d,error:r.password,required:!0}),n.jsx(ne,{label:"Confirm Password",id:"confirmPassword",name:"confirmPassword",type:"password",value:e.confirmPassword,onChange:d,error:r.confirmPassword,required:!0}),n.jsx(M,{type:"submit",className:"w-full mt-4",disabled:a,children:a?"Creating Account...":"Sign Up"})]}),n.jsx("div",{className:"mt-6 text-center text-sm",children:n.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",n.jsx($,{to:"/login",className:"text-primary-600 dark:text-primary-400 hover:underline",children:"Log in"})]})})]})},Xo=()=>{const{isAuthenticated:e}=Oe(),t=le();return k.useEffect(()=>{e&&t("/dashboard")},[e,t]),n.jsxs("div",{className:"max-w-md mx-auto py-12",children:[n.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Join LoopList"}),n.jsx(Yo,{})]})},fe="❤️‍🔥",Zo=({loop:e,onComplete:t,isPublic:r=!1,showReactions:s=!0})=>{const[a,o]=k.useState(!1),[i,l]=k.useState(null),[d,f]=k.useState(0),u=k.useRef(0),{data:h=0}=Bt((e==null?void 0:e.id)||(e==null?void 0:e._id));if(!e)return n.jsx(U,{className:"h-full flex flex-col items-center justify-center p-6",children:n.jsx("p",{className:"text-gray-500",children:"Loop data not available"})});const{_id:v,id:w,title:p,current_streak:x=0,longest_streak:m=0,frequency_type:N,frequency_details:j={},visibility:y="private",icon:C}=e,S=w||v;k.useEffect(()=>{console.log("Loop in LoopCard useEffect:",e),console.log("Loop reaction_count type:",typeof e.reaction_count),console.log("Loop reaction_count value:",e.reaction_count),console.log("Loop object keys:",Object.keys(e)),console.log("Loop object values:",Object.values(e));const E=Number(e.reaction_count||0);console.log("Setting reaction count in LoopCard:",E,"(original value:",e.reaction_count,")"),d!==E&&(f(E),u.current=E,console.log(`[DEBUG] Initialized reactionCountRef.current to ${E} in LoopCard`))},[e,e.reaction_count]),k.useEffect(()=>{console.log(`[DEBUG] LoopCard reaction count changed: ${d} for loop ${S}`),u.current=d,console.log(`[DEBUG] Updated reactionCountRef.current to ${u.current} in LoopCard`);const E=document.getElementById("debug-loopcard-reaction-count");E&&(E.setAttribute("data-count",d.toString()),E.textContent=`Current reaction count: ${d}`)},[d,S]),console.log("Loop in LoopCard:",e),console.log("Loop ID:",S),console.log("Loop title:",p),console.log("Loop user_id:",e.user_id),console.log("Loop status:",e.status),console.log("Loop frequency_type:",N),console.log("Loop frequency_details:",j),console.log("Loop visibility:",y);const L=()=>{try{switch(N){case"daily":return"Every day";case"weekly":return j&&j.days_of_week?`${j.days_of_week.length} days per week`:"Weekly";case"specific_days":if(j&&j.days_of_week){const E=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return j.days_of_week.map(R=>E[R-1]).join(", ")}return"Specific days";case"every_n_days":return j&&j.every_n_days?`Every ${j.every_n_days} days`:"Every N days";default:return"Custom"}}catch(E){return console.error("Error formatting frequency text:",E),"Custom schedule"}},_=async()=>{console.group("LOOPCARD REACTION HANDLER"),console.log("=== REACTION HANDLER START ==="),console.log("Initial state:",{loopId:S,currentReactionCount:d,isReacting:a,selectedEmoji:i});try{if(!S){console.error("Invalid loop ID for reaction"),console.groupEnd(),alert("Error: Cannot react to loop with invalid ID");return}o(!0),l(fe),console.log("Set isReacting to true and selectedEmoji to",fe);const E=d;f(D=>{const P=D+1;return console.log(`Incrementing local reaction count: ${D} -> ${P}`),u.current=P,console.log(`[DEBUG] Updated reactionCountRef.current to ${P} during increment in LoopCard`),P}),console.log(`Calling reactToLoop API with loopId: ${S}`);const b=await Nr(S,fe);if(console.log("Reaction API result:",b),typeof b=="number")console.log(`Setting reaction count from API numeric result: ${b}`),b===0?(console.log("API returned 0 for a reaction we just added, keeping incremented count"),u.current<1&&(u.current=1,console.log("[DEBUG] Forced reactionCountRef.current to 1 since API returned 0 in LoopCard"))):(f(b),u.current=b,console.log(`[DEBUG] Updated reactionCountRef.current to ${b} from API result in LoopCard`));else if(b&&typeof b=="object"&&b[fe]!==void 0){const D=b[fe];console.log(`Setting reaction count from API object result: ${D}`),D===0?(console.log("API returned 0 for a reaction we just added, keeping incremented count"),u.current<1&&(u.current=1,console.log("[DEBUG] Forced reactionCountRef.current to 1 since API returned 0 in LoopCard"))):(f(D),u.current=D,console.log(`[DEBUG] Updated reactionCountRef.current to ${D} from API object result in LoopCard`))}else console.log("API result format not recognized, keeping local increment");let R;typeof b=="number"?R=b===0?E+1:b:b&&typeof b=="object"&&b[fe]!==void 0?R=b[fe]===0?E+1:b[fe]:R=E+1,console.log(`Storing current reaction count for timeout: ${R}`),setTimeout(()=>{console.log("Timeout callback executing, resetting UI state"),o(!1),l(null);const D=u.current;console.log(`Checking reaction count in timeout: current=${D}, stored=${R}`),D===0&&R>0?(console.log(`Current count is 0 but should be at least 1, setting to ${R}`),f(R),u.current=R,console.log(`[DEBUG] Forced reactionCountRef.current to ${R} in timeout in LoopCard`)):D!==R&&R>0&&(console.log(`Reaction count changed during timeout, resetting to ${R}`),f(R),u.current=R,console.log(`[DEBUG] Updated reactionCountRef.current to ${R} in timeout in LoopCard`)),console.log("Final reaction count after API call:",R)},1500),console.log("=== REACTION HANDLER END ==="),console.groupEnd()}catch(E){console.error("Error reacting to loop:",E),f(b=>{const R=Math.max(0,b-1);return console.log(`Error occurred, reverting count: ${b} -> ${R}`),R}),alert(`Error reacting to loop: ${E.message||"Unknown error"}`),o(!1),l(null),console.log("=== REACTION HANDLER END WITH ERROR ==="),console.groupEnd()}};return n.jsxs(U,{className:"h-full flex flex-col",children:[n.jsxs("div",{id:"debug-loopcard-reaction-count",className:"hidden","data-count":d.toString(),children:["Current reaction count: ",d]}),n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx(Er,{loop:e}),C&&n.jsx("div",{className:"mr-3 text-2xl",children:C}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold",children:p}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:L()})]})]}),y==="public"&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Public"}),y==="friends_only"&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Friends"}),y==="private"&&n.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:"Private"})]}),n.jsx("div",{className:"flex justify-between mb-4",children:N==="x_times_per_week"?n.jsxs("div",{className:"w-full",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"}),n.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[h," times total"]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current Streak"}),n.jsx("p",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:x})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Longest Streak"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-600 dark:text-secondary-400",children:m})]})]})}),y==="public"&&s&&n.jsx("div",{className:"mb-4",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:n.jsxs("button",{onClick:_,disabled:a,className:`px-3 py-1.5 rounded-full text-sm flex items-center ${i===fe?"bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200":"bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"} transition-colors`,"data-reaction-count":d,"data-loop-reaction-count":e.reaction_count,children:[n.jsx("span",{children:fe}),n.jsx("span",{className:"text-xs font-medium ml-1",children:d})]})})}),n.jsxs("div",{className:"mt-auto pt-4 flex justify-between",children:[n.jsx($,{to:`/loops/${S}`,children:n.jsx(M,{variant:"outline",size:"sm",children:"Details"})}),!r&&n.jsx(M,{size:"sm",onClick:()=>{console.log(`Completing loop with ID: ${S}`),t(S)},children:"Complete Today"})]})]})},ei=()=>{const{user:e}=Oe(),[t,r]=k.useState("active"),[s,a]=k.useState(0),[o,i]=k.useState([]),l=12,d=k.useRef(null),[f,u]=k.useState(!0),{data:h=[],isLoading:v,error:w,isFetching:p}=Bo(t,s,l),x=en();console.log("Current user:",e),console.log("User ID:",e==null?void 0:e.id),console.log("Active status:",t),console.log("Page:",s),console.log("Loops data:",h),console.log("All loops:",o),console.log("Is loading:",v),console.log("Is fetching:",p),console.log("Error:",w),console.log("Has more:",f),k.useEffect(()=>{h&&(h.length<l&&u(!1),i(s===0?h:j=>[...j,...h]))},[h,s,l]),k.useEffect(()=>{a(0),i([]),u(!0)},[t]);const m=k.useCallback(j=>{const[y]=j;y.isIntersecting&&f&&!p&&a(C=>C+1)},[f,p]);k.useEffect(()=>{const j={root:null,rootMargin:"20px",threshold:0},y=new IntersectionObserver(m,j);return d.current&&y.observe(d.current),()=>{d.current&&y.unobserve(d.current)}},[m]);const N=j=>{try{if(!j){console.error("Invalid loop ID: Loop ID is undefined or null"),alert("Failed to complete loop: Invalid loop ID");return}const y=String(j);console.log(`Dashboard: Completing loop with ID: ${y}`),x.mutate({loopId:y},{onSuccess:C=>{console.log("Loop completed successfully:",C),alert("Loop completed successfully!")},onError:C=>{var S,L;console.error("Error completing loop:",C),alert(((L=(S=C.response)==null?void 0:S.data)==null?void 0:L.detail)||"Failed to complete loop. Please try again.")}})}catch(y){console.error("Error in handleComplete:",y),alert(`Error completing loop: ${y.message}`)}};return v&&s===0?n.jsx("div",{className:"flex justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):w&&s===0?n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Loops"}),n.jsx("p",{children:w.message||"An error occurred while loading your loops."}),n.jsx(M,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:"Try Again"})]}):n.jsxs("div",{children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),n.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Welcome back, ",(e==null?void 0:e.username)||"User","!"]})]}),n.jsx($,{to:"/loops/create",children:n.jsxs(M,{children:[n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Create Loop"]})})]}),n.jsxs("div",{className:"flex mb-6 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("button",{className:`px-4 py-2 font-medium ${t==="active"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>r("active"),children:"Active"}),n.jsx("button",{className:`px-4 py-2 font-medium ${t==="completed"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>r("completed"),children:"Completed"}),n.jsx("button",{className:`px-4 py-2 font-medium ${t==="archived"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>r("archived"),children:"Archived"})]}),o.length===0&&!v?n.jsxs(U,{className:"text-center py-12",children:[n.jsx("div",{className:"text-4xl mb-4",children:"🔍"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Loops Found"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:t==="active"?"You don't have any active loops yet.":`You don't have any ${t} loops.`}),t==="active"&&n.jsx($,{to:"/loops/create",children:n.jsx(M,{children:"Create Your First Loop"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(j=>n.jsx(Zo,{loop:j,onComplete:N,showReactions:!1},j.id||j._id))}),f&&n.jsx("div",{ref:d,className:"flex justify-center py-8 mt-4",children:p&&n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}),!f&&o.length>0&&n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:n.jsx("p",{children:"You've reached the end of your loops"})})]})]})},ti=({loopId:e})=>{const[t,r]=k.useState(new Date),[s,a]=k.useState(new Date),{data:o}=Cr(e),{data:i=0}=Bt(e),l=new Date(s.getFullYear(),s.getMonth(),1),d=new Date(s.getFullYear(),s.getMonth()+1,0),{data:f=[],isLoading:u}=Ko(e,l.toISOString().split("T")[0],d.toISOString().split("T")[0]),h=f.map(m=>new Date(m)),[v,w]=k.useState(0);k.useEffect(()=>{var m,N,j;if(o&&o.start_date){const y=new Date(o.start_date);y.setHours(0,0,0,0);const C=new Date;if(C.setHours(0,0,0,0),y>C){w(0);return}const S=Math.max(1,Math.floor((C-y)/(1e3*60*60*24))+1);console.log(`Days since start: ${S}`);let L=0;switch(o.frequency_type){case"daily":L=S;break;case"specific_days":const _=((m=o.frequency_details)==null?void 0:m.days)||[];if(_.length>0){let D=0;const P=new Date(y);for(;P<=C;){const q=P.getDay();_.includes(q)&&D++,P.setDate(P.getDate()+1)}L=D}break;case"every_n_days":const E=((N=o.frequency_details)==null?void 0:N.n)||1;L=Math.floor(S/E)+1;break;case"x_times_per_week":const b=((j=o.frequency_details)==null?void 0:j.count)||1,R=Math.ceil(S/7);L=Math.min(R*b,S);break;default:L=S}if(console.log(`Expected completions: ${L}`),console.log(`Actual completions: ${i}`),L>0){const _=Math.min(100,Math.round(i/L*100));w(_)}else w(0)}else w(0)},[o,i]);const p=({date:m,view:N})=>N!=="month"?null:h.some(y=>y.getDate()===m.getDate()&&y.getMonth()===m.getMonth()&&y.getFullYear()===m.getFullYear())?n.jsx("div",{className:"relative flex items-center justify-center pointer-events-none",children:n.jsx("div",{className:"w-3 h-3 bg-white dark:bg-white rounded-full"})}):null,x=({date:m,view:N})=>{var S,L,_;if(N!=="month")return"";const j=new Date;if(j.setHours(0,0,0,0),m>j)return"bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-500 opacity-50";const C=h.some(E=>E.getDate()===m.getDate()&&E.getMonth()===m.getMonth()&&E.getFullYear()===m.getFullYear());if(o&&o.start_date){const E=new Date(o.start_date);E.setHours(0,0,0,0);const b=new Date;if(b.setHours(0,0,0,0),E>b)return console.log("Loop hasn't started yet, all dates should be neutral"),"bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-500";if(m<E)return"bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-500"}if(C)return"!bg-green-600 dark:!bg-green-700 !text-white dark:!text-white !font-bold";if(o&&o.start_date){const E=new Date(o.start_date);E.setHours(0,0,0,0);const b=new Date;if(b.setHours(0,0,0,0),E>b)return"bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-300";if(o.frequency_type==="x_times_per_week"){const R=((S=o.frequency_details)==null?void 0:S.count)||1,D=m.getDay(),P=new Date(m);P.setDate(m.getDate()-D);const q=new Date(P);q.setDate(P.getDate()+6);const J=q<j,Ge=!J&&P<=j&&q>=j,Rr=o.end_date?new Date(o.end_date):null;if(Rr&&m>Rr)return"bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-500 opacity-50";let Sr=0;return h.forEach(Ht=>{const _r=new Date(Ht);_r.setDate(Ht.getDate()-Ht.getDay()),_r.getTime()===P.getTime()&&Sr++}),J&&Sr<R&&P>=E?"!bg-red-600 dark:!bg-red-800 !text-white dark:!text-white":Ge?"bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-300":"bg-gray-100 dark:bg-gray-900 text-gray-500 dark:text-gray-500 opacity-50"}if(o.frequency_type==="daily"&&m>=E&&m<=j)return"!bg-red-600 dark:!bg-red-800 !text-white dark:!text-white";if(o.frequency_type==="specific_days"){const R=((L=o.frequency_details)==null?void 0:L.days)||[],D=m.getDay();if(R.includes(D)&&m>=E&&m<=j)return"!bg-red-600 dark:!bg-red-800 !text-white dark:!text-white"}if(o.frequency_type==="every_n_days"){const R=((_=o.frequency_details)==null?void 0:_.n)||1;if(Math.floor((m-E)/(1e3*60*60*24))%R===0&&m>=E&&m<=j)return"!bg-red-600 dark:!bg-red-800 !text-white dark:!text-white"}}return"bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-300"};return n.jsxs(U,{className:"w-full dark:bg-gray-800",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Loop Heatmap Calendar"}),v>0&&n.jsxs("div",{className:"mt-2 md:mt-0 flex items-center",children:[n.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:"Completion Rate:"}),n.jsx("div",{className:"w-24 h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full ${v>=80?"bg-green-500 dark:bg-green-600":v>=50?"bg-yellow-500 dark:bg-yellow-600":"bg-red-500 dark:bg-red-600"}`,style:{width:`${v}%`}})}),n.jsxs("div",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[v,"%"]})]})]}),u?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 dark:border-primary-400"})}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"calendar-container relative z-10 w-full overflow-x-auto dark:text-gray-200",children:n.jsx(ln,{onChange:r,value:t,onActiveStartDateChange:({activeStartDate:m})=>a(m),tileContent:p,tileClassName:x,className:"w-full border-0 min-w-full dark:bg-gray-800"})}),n.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-4 text-sm",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-4 h-4 bg-green-600 dark:bg-green-700 rounded mr-1"}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Completed"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-4 h-4 bg-red-600 dark:bg-red-800 rounded mr-1"}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Missed"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-4 h-4 bg-gray-100 dark:bg-gray-900 rounded mr-1 opacity-50"}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Future/Inactive"})]})]})]})]})},ri=()=>{var m;const{loopId:e}=fs(),t=le(),r=ge(),{data:s,isLoading:a,error:o}=Cr(e),{data:i=0,isLoading:l}=Bt(e),d=en(),f=zo(),[u,h]=k.useState(!1);k.useEffect(()=>{e&&(r.invalidateQueries({queryKey:["completion-count",e]}),r.invalidateQueries({queryKey:["loop-calendar",e]}))},[e,r]);const v=()=>{d.mutate({loopId:e},{onError:N=>{var j,y,C,S;((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.detail)==="Loop already completed for this date"?alert("You've already completed this loop for today!"):(console.error("Error completing loop:",N),alert(((S=(C=N.response)==null?void 0:C.data)==null?void 0:S.detail)||"Failed to complete loop. Please try again."))},onSuccess:()=>{alert("Loop completed successfully!")}})},w=async()=>{try{await f.mutateAsync(e),t("/dashboard")}catch(N){console.error("Error archiving loop:",N)}},p=()=>{if(!s)return"";const N=s.frequency_details||{};try{switch(s.frequency_type){case"daily":return"Every day";case"weekly":return`${(N.days_of_week||[]).length} days per week`;case"specific_days":const y=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return(N.days_of_week||[]).map(L=>y[L-1]).join(", ")||"No days selected";case"every_n_days":return`Every ${N.n||0} days`;case"x_times_per_week":return`${N.count||0} times per week`;default:return"Custom"}}catch(j){return console.error("Error formatting frequency text:",j),"Custom schedule"}},x=()=>{if(!s)return null;try{return s.frequency_type==="x_times_per_week"||s.frequency_type==="custom"||s.frequency_type==="every_n_days"?n.jsxs("div",{children:[n.jsxs("p",{className:"text-md font-medium text-primary-600 dark:text-primary-400 mt-2",children:["Completed ",l?"...":i," times total"]}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Started on ",new Date(s.start_date).toLocaleDateString()]})]}):n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Started on ",new Date(s.start_date).toLocaleDateString()]})}catch(N){return console.error("Error formatting additional frequency info:",N),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Started on ",s.start_date?new Date(s.start_date).toLocaleDateString():"unknown date"]})}};return a?n.jsx("div",{className:"flex justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e==="undefined"||!e?n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Loop"}),n.jsx("p",{children:"Invalid loop ID. This may happen if the loop was not created properly."}),n.jsx("button",{className:"mt-4 text-primary-600 dark:text-primary-400 hover:underline",onClick:()=>t("/dashboard"),children:"Return to Dashboard"})]}):o||!s?n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Loop"}),n.jsx("p",{children:(o==null?void 0:o.message)||"The loop could not be found."}),n.jsx("button",{className:"mt-4 text-primary-600 dark:text-primary-400 hover:underline",onClick:()=>t("/dashboard"),children:"Return to Dashboard"})]}):n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[n.jsxs("div",{children:[n.jsxs($,{to:"/dashboard",className:"text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 mb-2 inline-flex items-center",children:[n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:n.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Dashboard"]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx(Er,{loop:s,size:"lg",showLabel:!0}),n.jsxs("h1",{className:"text-3xl font-bold flex items-center ml-3",children:[s.icon&&n.jsx("span",{className:"mr-3 text-3xl",children:s.icon}),s.title]})]})]}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx($,{to:`/loops/${e}/edit`,children:n.jsx(M,{variant:"outline",children:"Edit Loop"})}),s.status==="active"&&n.jsx(M,{onClick:v,children:"Complete Today"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.frequency_type==="x_times_per_week"?n.jsxs(U,{className:"relative md:col-span-2",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx("span",{className:"text-2xl",title:"Completion count",children:"✅"})}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Completions"}),n.jsxs("p",{className:"text-4xl font-bold text-green-600 dark:text-green-400",children:[i," times total"]}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Goal: ",((m=s.frequency_details)==null?void 0:m.count)||1," times per week"]})]}):n.jsxs(n.Fragment,{children:[n.jsxs(U,{className:"relative",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx("span",{className:"text-2xl",title:"Current streak",children:"🟩"})}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Current Streak"}),n.jsx("p",{className:"text-4xl font-bold text-primary-600 dark:text-primary-400",children:s.current_streak}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"days"})]}),n.jsxs(U,{className:"relative",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx("span",{className:"text-2xl",title:"Longest streak",children:"🔥"})}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Longest Streak"}),n.jsx("p",{className:"text-4xl font-bold text-secondary-600 dark:text-secondary-400",children:s.longest_streak}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"days"})]}),n.jsxs(U,{className:"relative",children:[n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx("span",{className:"text-2xl",title:"Completion count",children:"✅"})}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Completions"}),n.jsx("p",{className:"text-4xl font-bold text-green-600 dark:text-green-400",children:i}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"total check-ins"})]})]}),n.jsxs(U,{children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Frequency"}),n.jsx("p",{className:"text-xl",children:p()}),x()]})]}),n.jsx("div",{className:"mb-8 w-full",children:n.jsx(ti,{loopId:e})}),n.jsxs(U,{className:"mb-8",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Loop Settings"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Visibility"}),n.jsxs("p",{className:"font-medium",children:[s.visibility==="public"?"Public":"Private",s.visibility==="public"&&n.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"On Leaderboard"})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),n.jsx("p",{className:"font-medium capitalize",children:s.status})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),n.jsx("p",{className:"font-medium",children:new Date(s.created_at).toLocaleDateString()})]}),s.end_date&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"End Date"}),n.jsx("p",{className:"font-medium",children:new Date(s.end_date).toLocaleDateString()})]})]})]}),n.jsxs(U,{className:"border border-red-200 dark:border-red-800",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Danger Zone"}),u?n.jsxs("div",{children:[n.jsx("p",{className:"mb-4 text-gray-700 dark:text-gray-300",children:"Are you sure you want to archive this loop? This action will hide the loop from your dashboard."}),n.jsxs("div",{className:"flex space-x-3",children:[n.jsx(M,{variant:"danger",onClick:w,disabled:f.isPending,children:f.isPending?"Archiving...":"Yes, Archive Loop"}),n.jsx(M,{variant:"outline",onClick:()=>h(!1),children:"Cancel"})]})]}):n.jsx(M,{variant:"danger",onClick:()=>h(!0),children:"Archive Loop"})]})]})},si=[{value:"daily",label:"Every day"},{value:"specific_days",label:"Specific days of the week"},{value:"every_n_days",label:"Every N days"},{value:"x_times_per_week",label:"X times per week"}],ni=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"},{value:7,label:"Sunday"}],ai=[{value:"private",label:"Private"},{value:"friends_only",label:"Friends Only"},{value:"public",label:"Public"}],tn=({initialData:e={},onSubmit:t,isSubmitting:r,buttonText:s="Create Loop"})=>{const[a,o]=k.useState({title:"",frequency_type:"daily",frequency_details:{},visibility:"private",icon:"",...e}),[i,l]=k.useState({}),d=p=>{const{name:x,value:m}=p.target;o(N=>({...N,[x]:m}))},f=p=>{const x=p.target.value;let m={};switch(x){case"specific_days":m={days:[]};break;case"every_n_days":m={n:2};break;case"x_times_per_week":m={count:3};break;default:m={}}o(N=>({...N,frequency_type:x,frequency_details:m}))},u=p=>{const x=p===7?0:p,m=a.frequency_details.days||[],N=m.includes(x)?m.filter(j=>j!==x):[...m,x];o(j=>({...j,frequency_details:{...j.frequency_details,days:N}}))},h=p=>{const{name:x,value:m}=p.target;let N;x==="every_n_days"?N="n":x==="times_per_week"?N="count":N=x,o(j=>({...j,frequency_details:{...j.frequency_details,[N]:parseInt(m,10)}}))},v=()=>{const p={};return a.title.trim()||(p.title="Title is required"),a.frequency_type==="specific_days"&&(!a.frequency_details.days||a.frequency_details.days.length===0)&&(p.days_of_week="Select at least one day"),a.frequency_type==="every_n_days"&&(!a.frequency_details.n||a.frequency_details.n<1)&&(p.every_n_days="Must be at least 1"),a.frequency_type==="x_times_per_week"&&(!a.frequency_details.count||a.frequency_details.count<1||a.frequency_details.count>7)&&(p.times_per_week="Must be between 1 and 7"),a.start_date||(a.start_date=new Date().toISOString().split("T")[0]),l(p),Object.keys(p).length===0},w=p=>{p.preventDefault(),v()&&t(a)};return n.jsx(U,{children:n.jsxs("form",{onSubmit:w,children:[n.jsx(ne,{label:"Loop Title",id:"title",name:"title",value:a.title,onChange:d,placeholder:"e.g., Daily Meditation",error:i.title,required:!0}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Frequency"}),n.jsx("select",{name:"frequency_type",value:a.frequency_type,onChange:f,className:"input",children:si.map(p=>n.jsx("option",{value:p.value,children:p.label},p.value))})]}),a.frequency_type==="specific_days"&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Select Days",i.days_of_week&&n.jsx("span",{className:"text-red-500 ml-2",children:i.days_of_week})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:ni.map(p=>{var x;return n.jsx("button",{type:"button",className:`px-3 py-1 rounded-full text-sm ${(x=a.frequency_details.days)!=null&&x.includes(p.value===7?0:p.value)?"bg-primary-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>u(p.value),children:p.label.substring(0,3)},p.value)})})]}),a.frequency_type==="every_n_days"&&n.jsx(ne,{label:"Every N Days",id:"every_n_days",name:"every_n_days",type:"number",min:"1",value:a.frequency_details.n||"",onChange:h,error:i.every_n_days}),a.frequency_type==="x_times_per_week"&&n.jsx(ne,{label:"Times Per Week",id:"times_per_week",name:"times_per_week",type:"number",min:"1",max:"7",value:a.frequency_details.count||"",onChange:h,error:i.times_per_week}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Visibility"}),n.jsx("select",{name:"visibility",value:a.visibility,onChange:d,className:"input",children:ai.map(p=>n.jsx("option",{value:p.value,children:p.label},p.value))}),a.visibility==="public"&&n.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Public loops will appear on the leaderboard and can be viewed by anyone."}),a.visibility==="friends_only"&&n.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Friends-only loops will only be visible to your friends."})]}),n.jsx(ne,{label:"Icon (emoji)",id:"icon",name:"icon",value:a.icon||"",onChange:d,placeholder:"e.g., 🧘‍♀️"}),n.jsx(M,{type:"submit",className:"w-full mt-4",disabled:r,children:r?"Saving...":s})]})})},oi=()=>{const e=le(),t=Ho(),[r,s]=k.useState(null),a=async o=>{s(null);try{const i=await t.mutateAsync(o);console.log("Loop creation response:",i);const l=i&&(i.id||i._id);l?e(`/loops/${l}`):(s("Failed to create loop: Invalid response from server"),console.error("Invalid loop response:",i))}catch(i){s(`Error creating loop: ${i.message||"Unknown error"}`),console.error("Error creating loop:",i)}};return n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create a New Loop"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Define a new micro-habit to track. Be specific about what you want to accomplish and how often."}),r&&n.jsx(U,{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:n.jsx("div",{className:"text-red-600 dark:text-red-400",children:r})}),n.jsx(tn,{onSubmit:a,isSubmitting:t.isPending,buttonText:"Create Loop"})]})},ii=()=>{const{loopId:e}=fs(),t=le(),{data:r,isLoading:s,error:a}=Cr(e),o=Qo(),i=async l=>{try{await o.mutateAsync({loopId:e,data:l}),t(`/loops/${e}`)}catch(d){console.error("Error updating loop:",d)}};return s?n.jsx("div",{className:"flex justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a||!r?n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Loop"}),n.jsx("p",{children:(a==null?void 0:a.message)||"The loop could not be found."}),n.jsx("button",{className:"mt-4 text-primary-600 dark:text-primary-400 hover:underline",onClick:()=>t("/dashboard"),children:"Return to Dashboard"})]}):n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Edit Loop"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Update your loop details below."}),n.jsx(tn,{initialData:r,onSubmit:i,isSubmitting:o.isPending,buttonText:"Save Changes"})]})},li=()=>{const{isAuthenticated:e}=Oe(),[t,r]=k.useState(0),[s,a]=k.useState([]),o=10,i=ge(),l=le(),d=k.useRef(null),[f,u]=k.useState(!0),{data:h,isLoading:v,error:w,isFetching:p}=We({queryKey:["top-streaks",t],queryFn:()=>_o(t*o,o),staleTime:1e3*60*5,keepPreviousData:!0});k.useEffect(()=>{h&&(h.length<o&&u(!1),a(t===0?h:y=>[...y,...h]))},[h,t,o]);const x=k.useCallback(y=>{const[C]=y;C.isIntersecting&&f&&!p&&r(S=>S+1)},[f,p]);k.useEffect(()=>{const y={root:null,rootMargin:"20px",threshold:0},C=new IntersectionObserver(x,y);return d.current&&C.observe(d.current),()=>{d.current&&C.unobserve(d.current)}},[x]);const m=async y=>{console.group("LEADERBOARD REACTION HANDLER"),console.log("=== LEADERBOARD REACTION HANDLER START ==="),console.log("Loop ID:",y);try{const C=s.find(E=>(E.id||E._id)===y);if(!C){console.error(`Loop with ID ${y} not found in current data`),console.groupEnd();return}console.log("Found loop to update:",C),console.log("Current reaction_count:",C.reaction_count||0);const S=s.map(E=>{if((E.id||E._id)===y){const b=(Number(E.reaction_count)||0)+1;return console.log(`Incrementing local reaction count: ${E.reaction_count||0} -> ${b}`),{...E,reaction_count:b}}return E});console.log("Updating local state with incremented count"),a(S),console.log(`Calling reactToLoop API with loopId: ${y}`);const L=await Nr(y);console.log("Reaction API result:",L);let _;if(typeof L=="number")_=L,console.log(`API returned numeric reaction count: ${_}`),_===0&&(console.log("API returned 0 for a reaction we just added, using 1 instead"),_=1);else if(L&&typeof L=="object"&&L["❤️‍🔥"]!==void 0)_=L["❤️‍🔥"],console.log(`API returned object with reaction count: ${_}`),_===0&&(console.log("API returned 0 for a reaction we just added, using 1 instead"),_=1);else{const E=s.find(b=>(b.id||b._id)===y);_=((E==null?void 0:E.reaction_count)||0)+1,console.log(`Could not determine API count, using incremented count: ${_}`)}console.log(`Final reaction count to use: ${_}`),console.log(`Updating local state with final API count: ${_}`),a(E=>E.map(b=>(b.id||b._id)===y?{...b,reaction_count:_}:b)),console.log("Setting timeout to refetch leaderboard data"),setTimeout(()=>{console.log("Refetching leaderboard data"),i.invalidateQueries(["leaderboard"]),setTimeout(()=>{const E=s.find(b=>(b.id||b._id)===y);E&&(console.log(`Current reaction count after refetch: ${E.reaction_count||0}`),E.reaction_count!==_&&_>0?(console.log(`Count mismatch after refetch, updating to API count: ${_}`),a(b=>b.map(R=>(R.id||R._id)===y?{...R,reaction_count:_}:R))):E.reaction_count===0&&_>0&&(console.log(`Refetched count is 0 but API count is ${_}, keeping API count`),a(b=>b.map(R=>(R.id||R._id)===y?{...R,reaction_count:_}:R))))},500)},500),console.log("=== LEADERBOARD REACTION HANDLER END ==="),console.groupEnd()}catch(C){console.error("Error reacting to loop:",C),console.error("Error details:",{message:C.message,stack:C.stack}),console.log("Reverting local changes due to error"),i.invalidateQueries(["leaderboard"]),console.log("=== LEADERBOARD REACTION HANDLER END WITH ERROR ==="),console.groupEnd()}},N=async y=>{var C,S,L,_,E;if(!e){l("/login");return}if(!y||y==="undefined"){console.error("Invalid loop ID:",y),alert("Error: Cannot clone loop with invalid ID");return}try{console.log("Cloning loop with ID:",y);const b=document.getElementById(`clone-button-${y}`);b&&(b.textContent="Cloning...",b.disabled=!0);const R=await Zs(y);if(console.log("Clone result:",R),!R||!R.id&&!R._id)throw new Error("Invalid response: Missing loop ID in response");alert("Loop cloned successfully! Check your dashboard."),b&&(b.textContent="Clone",b.disabled=!1),i.invalidateQueries(["top-streaks"]),i.invalidateQueries(["loops"])}catch(b){console.error("Error cloning loop:",b);const R=document.getElementById(`clone-button-${y}`);R&&(R.textContent="Clone",R.disabled=!1),b.name==="TypeError"&&b.message.includes("Cannot read properties of undefined")?(console.error("API response is undefined or invalid"),alert("Error: Server returned an invalid response. Please try again later.")):((C=b.response)==null?void 0:C.status)===404?alert("Error: Loop not found or not available for cloning."):((S=b.response)==null?void 0:S.status)===403||((L=b.response)==null?void 0:L.status)===401?alert("Error: You are not authorized to clone this loop. Please log in again."):b.message.includes("Network Error")||b.message.includes("CORS")?alert("Network error: Could not connect to the server. CORS issue detected."):b.message.includes("Invalid response")||b.message.includes("empty response data")?alert("Error: Server returned an incomplete response. Please try again later."):alert(`Error cloning loop: ${((E=(_=b.response)==null?void 0:_.data)==null?void 0:E.detail)||b.message||"Unknown error"}`)}};if(v&&t===0)return n.jsx("div",{className:"flex justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(w&&t===0)return n.jsxs(U,{className:"bg-red-50 border border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Leaderboard"}),n.jsx("p",{children:w.message||"An error occurred while loading the leaderboard."}),n.jsx(M,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:"Try Again"})]});const j=s||[];return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Leaderboard"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Check out the top 10 loops with the longest active streaks. Get inspired or clone a loop to start your own streak!"}),j.length===0?n.jsxs(U,{className:"text-center py-12",children:[n.jsx("div",{className:"text-4xl mb-4",children:"🏆"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Loops Found"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Be the first to create a loop with a streak and top the leaderboard!"}),e?n.jsx($,{to:"/loops/create",children:n.jsx(M,{children:"Create a Loop"})}):n.jsx($,{to:"/signup",children:n.jsx(M,{children:"Sign Up to Create Loops"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Rank"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Loop"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Streak"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reactions"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:j.map((y,C)=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:["#",t*o+C+1]})}),n.jsx("td",{className:"px-6 py-4",children:n.jsxs("div",{className:"flex items-center",children:[y.icon&&n.jsx("div",{className:"text-2xl mr-3",children:y.icon}),n.jsxs("div",{children:[n.jsx("div",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:y.title}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["by ",y.user_username||"Anonymous"," • ",y.clone_count||0," clones"]})]})]})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:y.current_streak}),n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"days"})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("button",{className:"flex items-center px-3 py-1.5 rounded-full text-sm bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700 transition-colors",onClick:()=>{const S=y.id||y._id;if(!S){console.error("Loop ID is undefined or null",y);return}m(S)},children:[n.jsx("span",{children:"❤️‍🔥"}),n.jsx("span",{className:"text-xs font-medium ml-1",children:y.reaction_count||0})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx(M,{id:`clone-button-${y.id||y._id}`,variant:"outline",size:"sm",onClick:()=>{const S=y.id||y._id;if(!S){console.error("Loop ID is undefined or null",y),alert("Error: Cannot clone loop with undefined ID");return}N(S)},children:"Clone"})})]},y.id||y._id))})]})}),f&&n.jsx("div",{ref:d,className:"flex justify-center py-4 mt-4",children:p&&n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}),!f&&j.length>0&&n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:n.jsx("p",{children:"You've reached the end of the leaderboard"})})]})]})},ci=async(e=0,t=10)=>(await Q.get("/friends/me/friends",{params:{skip:e,limit:t}})).data,di=async e=>(await Q.get("/friends/check-user",{params:{email:e}})).data,ui=async({email:e})=>{try{const t=await di(e);if(console.log("Check user exists result:",t),!t.exists)throw new Error("User with this email not found");return(await Q.post("/friends/me/friends",{email:e})).data}catch(t){throw console.error("Error in addFriend:",t),t}},hi=async e=>(await Q.delete(`/friends/me/friends/${e}`)).data,fi=()=>{var _,E;const[e,t]=k.useState(""),[r,s]=k.useState(""),a=ge(),[o,i]=k.useState(0),[l,d]=k.useState([]),f=10,u=k.useRef(null),[h,v]=k.useState(!0),{data:w=[],isLoading:p,isError:x,error:m,isFetching:N}=We({queryKey:["friends",o],queryFn:()=>ci(o*f,f),onError:b=>{console.error("Error fetching friends:",b)},retry:1,keepPreviousData:!0});k.useEffect(()=>{w&&(w.length<f&&v(!1),d(o===0?w:b=>[...b,...w]))},[w,o,f]);const j=k.useCallback(b=>{const[R]=b;R.isIntersecting&&h&&!N&&i(D=>D+1)},[h,N]);k.useEffect(()=>{const b={root:null,rootMargin:"20px",threshold:0},R=new IntersectionObserver(j,b);return u.current&&R.observe(u.current),()=>{u.current&&R.unobserve(u.current)}},[j]);const y=ct({mutationFn:ui,onSuccess:()=>{t(""),s(""),i(0),d([]),v(!0),a.invalidateQueries(["friends"])},onError:b=>{var R,D;console.error("Error adding friend:",b),b.message==="User with this email not found"?s(`No user found with email: ${e}`):(D=(R=b.response)==null?void 0:R.data)!=null&&D.detail?s(b.response.data.detail):s("Failed to add friend. Please try again.")}}),C=ct({mutationFn:hi,onSuccess:()=>{i(0),d([]),v(!0),a.invalidateQueries(["friends"])},onError:b=>{var R,D;console.error("Error removing friend:",b),alert(((D=(R=b.response)==null?void 0:R.data)==null?void 0:D.detail)||"Failed to remove friend")}}),S=b=>{if(b.preventDefault(),!e.trim()){s("Email is required");return}const R=e.trim().toLowerCase();y.mutate({email:R})},L=b=>{window.confirm("Are you sure you want to remove this friend?")&&C.mutate(b)};return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Friends"}),n.jsxs(U,{className:"mb-8",children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add a Friend"}),n.jsxs("form",{onSubmit:S,className:"flex flex-col md:flex-row gap-4",children:[n.jsx("div",{className:"flex-grow",children:n.jsx(ne,{id:"email",name:"email",type:"email",placeholder:"Enter friend's email",value:e,onChange:b=>t(b.target.value),error:r,required:!0,className:"w-full"})}),n.jsx(M,{type:"submit",disabled:y.isLoading,className:"whitespace-nowrap",children:y.isLoading?"Adding...":"Add Friend"})]})]}),n.jsxs(U,{children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Your Friends"}),p&&o===0?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}):x&&o===0?n.jsxs("div",{className:"text-center py-8 text-red-500",children:[n.jsx("p",{children:"Error loading friends. Please try again."}),m&&n.jsx("p",{className:"mt-2 text-sm",children:((E=(_=m.response)==null?void 0:_.data)==null?void 0:E.detail)||m.message||"Unknown error"}),n.jsx(M,{className:"mt-4",variant:"outline",onClick:()=>a.invalidateQueries(["friends"]),children:"Retry"})]}):l.length===0&&!p?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("p",{className:"mb-4",children:"You haven't added any friends yet."}),n.jsx("p",{children:"Add friends by email to share your loops with them!"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Username"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:l.map(b=>n.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:b.username||"No username"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.email})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:n.jsx(M,{variant:"danger",size:"sm",onClick:()=>L(b.id||b._id),disabled:C.isLoading,children:"Remove"})})]},b.id||b._id))})]})}),h&&n.jsx("div",{ref:u,className:"flex justify-center py-8 mt-4",children:N&&n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}),!h&&l.length>0&&n.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:n.jsx("p",{children:"You've reached the end of your friends list"})})]})]})]})},mi=new Sn({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function pi(){return n.jsx(On,{client:mi,children:n.jsx(Eo,{children:n.jsx(nn,{children:n.jsxs("div",{className:"flex flex-col min-h-screen w-full",children:[n.jsx(Co,{}),n.jsx("main",{className:"flex-grow w-full",children:n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs(an,{children:[n.jsx(de,{path:"/",element:n.jsx(Go,{})}),n.jsx(de,{path:"/login",element:n.jsx(Vo,{})}),n.jsx(de,{path:"/signup",element:n.jsx(Xo,{})}),n.jsx(de,{path:"/dashboard",element:n.jsx(ei,{})}),n.jsx(de,{path:"/loops/create",element:n.jsx(oi,{})}),n.jsx(de,{path:"/loops/:loopId",element:n.jsx(ri,{})}),n.jsx(de,{path:"/loops/:loopId/edit",element:n.jsx(ii,{})}),n.jsx(de,{path:"/leaderboard",element:n.jsx(li,{})}),n.jsx(de,{path:"/friends",element:n.jsx(fi,{})}),n.jsx(de,{path:"*",element:n.jsx(on,{to:"/",replace:!0})})]})})}),n.jsx(Ro,{})]})})})})}const yi=document.getElementById("root");if(!yi){const e=document.createElement("div");e.id="root",e.className="min-h-screen w-full",document.body.appendChild(e)}hn.createRoot(document.getElementById("root")).render(n.jsx(k.StrictMode,{children:n.jsx(pi,{})}));
